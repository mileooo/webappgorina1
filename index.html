<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bravo Market ‚Äî —Å–≤–µ–∂–∏–µ –æ–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;900&display=swap" rel="stylesheet">

<style>
:root{
  --white:#FFFFFF;
  --card-bg:#FAF9F6;
  --brand:#A4DE02;
  --cta:#FF8C42;
  --text:#2E2E2E;
  --muted:#666666;
  --border:#E6E6E6;
  --shadow: 0 2px 8px rgba(0,0,0,0.05);
  --container:1100px;
  --pill-bg: rgba(164,222,2,0.08);
}

/* –±–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ */
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--white);color:var(--text);font-family:'Montserrat',Arial,sans-serif;font-weight:300;-webkit-font-smoothing:antialiased}
a{color:inherit;text-decoration:none}
button,input,select,textarea{font-family:'Montserrat',Arial,sans-serif}
h1,h2,h3,h4,h5,.logo h4,.name,.price{font-weight:900}

/* layout */
.container{max-width:var(--container);margin:0 auto;padding:16px;}
.header{position:sticky;top:0;z-index:70;background:var(--white);backdrop-filter:blur(4px);border-bottom:1px solid var(--border)}
.header-inner{max-width:var(--container);margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:10px 16px;gap:12px}
.logo{display:flex;align-items:center;gap:10px}
.logo .mark{width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,var(--brand),#7cc900);display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px rgba(164,222,2,0.12)}
.logo .mark svg{width:20px;height:20px;fill:#fff}
.logo h4{font-size:16px;margin:0;color:var(--text)}
.header-right{display:flex;align-items:center;gap:10px}

/* header small user area */
.user-btn{display:flex;align-items:center;gap:8px;padding:6px 8px;border-radius:10px;border:1px solid var(--border);background:#fff;cursor:pointer}
.user-name{font-weight:700;font-size:13px}

/* search / hero (hero background set to white per request) */
.search-wrap{display:flex;align-items:center;gap:8px;background:#fff;padding:6px;border-radius:12px;border:1px solid var(--border)}
.search-wrap input{border:0;outline:0;padding:8px 10px;width:220px;border-radius:8px;font-weight:300}
.sort-select{padding:8px;border-radius:8px;border:1px solid var(--border);background:#fff;font-weight:300}
.loyalty-badge{background:linear-gradient(180deg,#fff,#f4fff0);padding:6px 10px;border-radius:999px;border:1px solid rgba(164,222,2,0.12);font-weight:700;color:#2e2e2e;font-size:13px}

/* hero - white background, text kept */
.hero{max-width:var(--container);margin:14px auto;padding:16px;background:var(--white);border-radius:10px;display:flex;gap:12px;align-items:center;box-shadow:0 1px 6px rgba(0,0,0,0.03)}
.hero-left{flex:1;min-width:180px}
.hero h1{font-size:20px;margin:0 0 6px;color:var(--text);line-height:1.02}
.hero p{font-size:13px;color:var(--muted);margin:0 0 8px;font-weight:300}
.btn-cta{background:var(--cta);color:#fff;border:0;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer;box-shadow:0 6px 18px rgba(255,140,66,0.12);transition:transform .14s}
.btn-secondary{background:transparent;border:1px solid var(--border);padding:6px 8px;border-radius:8px;color:var(--text);cursor:pointer;font-size:13px;transform:scale(1)}
.btn-secondary.small{transform:scale(0.67); /* 1.5x smaller visually */ }

/* filters - modern pills */
.controls{display:flex;gap:10px;align-items:center;margin:8px 0;flex-wrap:wrap}
.pills{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.pill{
  padding:8px 12px;border-radius:999px;background:transparent;border:1px solid var(--border);cursor:pointer;font-weight:700;font-size:13px;color:var(--text);box-shadow:0 2px 6px rgba(0,0,0,0.03);
  transition:all .18s;
}
.pill:hover{transform:translateY(-3px)}
.pill.active{background:var(--pill-bg);border-color:transparent;color:var(--text);box-shadow:0 8px 22px rgba(164,222,2,0.08)}

/* grid & cards */
.main{max-width:var(--container);margin:0 auto;padding:8px 16px 120px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px}
.card{background:var(--card-bg);border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.03);padding:8px;display:flex;flex-direction:column;gap:8px;min-height:260px;transition:transform .18s,box-shadow .18s;position:relative;overflow:hidden;cursor:pointer}
.card:hover{transform:translateY(-6px)}
.photo{height:56%;border-radius:8px;overflow:hidden;background:#fff;display:flex;align-items:center;justify-content:center}
.photo img{width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity .35s;border-radius:6px}
.info{display:flex;flex-direction:column;gap:6px;flex:1;padding:4px}
.name{font-size:14px;color:var(--text)}
.desc{font-size:12px;color:var(--muted);min-height:34px;font-weight:300}
.price{font-size:14px}
.actions{display:flex;align-items:center;gap:6px;justify-content:flex-end}
.qty-input{width:60px;padding:6px;border-radius:8px;border:1px solid var(--border);text-align:center;font-weight:300;font-size:13px}
.unit-select{padding:6px;border-radius:8px;border:1px solid var(--border);background:#fff;font-weight:300;font-size:13px}

/* —É–º–µ–Ω—å—à–µ–Ω–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "–í –∫–æ—Ä–∑–∏–Ω—É" */
.add-to-cart{background:var(--brand);color:#fff;border:0;padding:6px 8px;border-radius:8px;font-weight:700;cursor:pointer;box-shadow:0 6px 12px rgba(164,222,2,0.12);transition:background .12s;font-size:13px}
.add-to-cart:hover{background:var(--cta)}
.reco{margin-top:6px;font-size:12px;color:var(--muted);font-weight:300}

/* floating cart */
.floating-cart { position: fixed; bottom: 20px; right: 14px; background: var(--brand); color: #fff; padding: 10px 12px; border-radius: 999px; box-shadow: 0 8px 26px rgba(0,0,0,0.18); cursor: pointer; font-weight:700; z-index: 1000; display:flex; align-items:center; gap:10px; min-width:150px; justify-content:center; transition:transform .28s ease, opacity .28s ease, visibility .28s; opacity: 0; transform: translateY(12px) scale(.98); pointer-events: none; visibility: hidden;}
.floating-cart.visible { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; visibility: visible; }
.floating-cart .fc-info{display:flex;flex-direction:column;align-items:flex-start;line-height:1}
.floating-cart .fc-count{font-size:13px;font-weight:700}
.floating-cart .fc-total{font-size:13px;font-weight:900}

/* cart panel bottom */
.cart-panel{position:fixed;bottom:0;left:0;right:0;margin:0 auto;max-width:420px;width:calc(100% - 36px);background:var(--white);border-top-left-radius:16px;border-top-right-radius:16px;box-shadow:0 -12px 36px rgba(0,0,0,0.12);padding:12px;z-index:999;border:1px solid var(--border);transform: translateY(110%);transition: transform 0.28s cubic-bezier(.2,.9,.2,1);}
.cart-panel.show { transform: translateY(0); }
.cart-items{max-height:50vh;overflow:auto;display:flex;flex-direction:column;gap:8px;padding-right:8px}
.cart-row{display:flex;align-items:center;justify-content:space-between;background:#fbfbfb;padding:8px;border-radius:8px;border:1px solid var(--border)}
.cart-total{display:flex;justify-content:space-between;align-items:center;margin-top:8px;font-weight:900;font-size:15px}
.btn{padding:8px;border-radius:10px;border:0;cursor:pointer;font-weight:700;font-size:14px}
.btn-clear{background:#f2f2f2;color:var(--text)}
.btn-check{background:var(--brand);color:#fff}
.btn-check:hover{background:var(--cta)}
.cart-close-btn{background:transparent;border:0;font-size:18px;cursor:pointer;color:var(--muted)}

/* product modal */
.product-modal { position:fixed;left:0;top:0;right:0;bottom:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;z-index:1100; }
.product-modal .panel { width:640px;max-width:94%;background:var(--white);border-radius:12px;padding:18px;box-shadow:0 12px 36px rgba(0,0,0,0.18);color:var(--text) }
.product-modal h3{margin:0 0 8px;font-size:20px}
.product-modal .pm-top{display:flex;gap:12px;align-items:flex-start}
.product-modal img.pm-img{width:180px;height:120px;object-fit:cover;border-radius:8px;background:#f4f4f4}
.kbju-label{font-weight:600;margin-top:8px;color:var(--muted)}
.kbju{background:#f7f8f6;padding:10px;border-radius:8px;border:1px solid var(--border);font-weight:700;margin:6px 0}
.prod-desc{margin-top:10px;color:var(--muted);line-height:1.4}

/* search fab for mobile */
.search-fab { position: fixed; bottom: 20px; left: 14px; z-index: 1000; display: none; gap: 8px; align-items: center; }
.search-fab .fab-btn { width:44px;height:44px;border-radius:999px;background:#fff;border:1px solid var(--border);display:flex;align-items:center;justify-content:center;box-shadow:0 6px 18px rgba(0,0,0,0.08);cursor:pointer; }
.search-panel { position: fixed; left: 14px; bottom: 74px; z-index: 1000; background: white; border-radius:12px; box-shadow: 0 12px 36px rgba(0,0,0,0.12); padding:8px; width: calc(100% - 56px); max-width:360px; display:none; }
.search-panel.open { display:block; }

.fade-in{animation:fadeIn .35s ease both}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
.small{font-size:13px;color:var(--muted);font-weight:300}

/* responsive */
@media (max-width:900px){
  .hero h1{font-size:18px}
  .photo{height:52%}
  .card{min-height:240px}
  .search-wrap input{width:140px}
}
@media (max-width:600px){
  .container{padding:12px}
  .hero h1{font-size:16px}
  .grid{grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:8px}
  .product-modal .panel{padding:12px}
  .product-modal img.pm-img{width:120px;height:84px}
  .search-wrap{display:none}
  .search-fab{display:flex}
  .btn-secondary.small{transform:scale(0.9)} /* mobile tweak */
}
@media (min-width:601px){
  .search-panel{display:none !important}
  .search-fab{display:none !important}
}
</style>
</head>
<body>
<header class="header">
  <div class="header-inner">
    <div style="display:flex;align-items:center;gap:10px">
      <div class="logo">
        <div class="mark" aria-hidden>
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C8 6 4 6 2 8c2 2 2 6 6 10s8 6 10 6c-2-6 0-12-6-22z"/></svg>
        </div>
        <h4>Bravo Market</h4>
      </div>
      <div style="margin-left:10px" class="small">–°–≤–µ–∂–µ—Å—Ç—å, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å</div>
    </div>

    <div class="header-right">
      <div class="search-wrap" title="–ü–æ–∏—Å–∫ –ø–æ —Ç–æ–≤–∞—Ä–∞–º">
        <input id="search-input" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ë–∞–Ω–∞–Ω, –ü–æ–º–∏–¥–æ—Ä—ã)"/>
        <select id="sort-select" class="sort-select" title="–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞">
          <option value="default">–°–æ—Ä—Ç</option>
          <option value="price_asc">–¶–µ–Ω–∞ ‚Üë</option>
          <option value="price_desc">–¶–µ–Ω–∞ ‚Üì</option>
          <option value="name_asc">A ‚Üí –Ø</option>
          <option value="name_desc">–Ø ‚Üí A</option>
        </select>
      </div>

      <div class="loyalty-badge" id="loyalty-badge" title="–í–∞—à–∏ –±–∞–ª–ª—ã">–ë–∞–ª–ª—ã: 0</div>

      <div id="user-area" class="user-btn" title="–í–æ–π—Ç–∏ / –ü—Ä–æ—Ñ–∏–ª—å">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="flex-shrink:0"><path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10zM3 22c0-3 4-5 9-5s9 2 9 5" stroke="#2E2E2E" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <div class="user-name" id="ua-name">–í–æ–π—Ç–∏</div>
      </div>
    </div>
  </div>
</header>

<section class="hero container">
  <div class="hero-left">
    <h1>–°–≤–µ–∂–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã ‚Äî –ø—Ä—è–º–æ –∫ –≤–∞–º –¥–æ–º–æ–π</h1>
    <p>–î–æ—Å—Ç–∞–≤–∏–º –∑–∞ 60 –º–∏–Ω—É—Ç –∏–∑ —Ñ–µ—Ä–º–µ—Ä—Å–∫–∏—Ö —Ö–æ–∑—è–π—Å—Ç–≤. –í—ã–±–µ—Ä–∏ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞.</p>
    <div class="hero-cta">
      <button class="btn-cta" id="hero-order">–ó–∞–∫–∞–∑–∞—Ç—å —Å–µ–π—á–∞—Å</button>
      <button class="btn-secondary small" id="view-catalog">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞—Ç–∞–ª–æ–≥</button>
    </div>
  </div>
  <div class="hero-right" style="min-width:200px">
    <div class="hero-image" style="height:130px;border-radius:10px;overflow:hidden">
      <img src="images/svezhie-frukty.jpg" alt="–°–≤–µ–∂–∏–µ —Ñ—Ä—É–∫—Ç—ã" style="width:100%;height:100%;object-fit:cover;border-radius:8px" />
    </div>
  </div>
</section>

<main class="main container">
  <div class="controls">
    <div class="pills" id="filters">
      <button class="pill active" data-filter="all">–í—Å–µ</button>
      <button class="pill" data-filter="fruits">–§—Ä—É–∫—Ç—ã</button>
      <button class="pill" data-filter="vegetables">–û–≤–æ—â–∏</button>
      <button class="pill" data-filter="sets">–°–µ—Ç—ã</button>
      <button class="pill" data-filter="promo">–ê–∫—Ü–∏–∏</button>
    </div>
    <div style="margin-left:auto" class="small">–ü–æ–∫–∞–∑–∞–Ω–æ <span id="shown-count">0</span> —Ç–æ–≤–∞—Ä–æ–≤</div>
  </div>

  <div style="margin-top:12px" class="fade-in">
    <div id="catalog" class="grid"></div>
  </div>
</main>

<!-- cart panel (bottom sheet) -->
<aside id="cart-panel" class="cart-panel" aria-hidden="true">
  <h4>
    <span>–ö–æ—Ä–∑–∏–Ω–∞ <small style="color:var(--muted);font-weight:600">(<span id="cart-count-2">0</span>)</small></span>
    <button class="cart-close-btn" id="cart-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
  </h4>
  <div class="cart-items" id="cart-items"></div>
  <div class="cart-total"><span>–ò—Ç–æ–≥–æ</span><span id="cart-sum">0 ‚ÇΩ</span></div>
  <div class="cart-actions">
    <button id="clear-cart" class="btn btn-clear">–û—á–∏—Å—Ç–∏—Ç—å</button>
    <button id="goto-checkout" class="btn btn-check">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
  </div>
</aside>

<!-- Floating cart: hidden until first item added -->
<div id="floating-cart" class="floating-cart" role="button" aria-label="–û—Ç–∫—Ä—ã—Ç—å –∫–æ—Ä–∑–∏–Ω—É">
  <div style="display:flex;align-items:center;gap:8px">
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M6 6h15l-1.5 9h-12z" stroke="#fff" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="10" cy="20" r="1" fill="#fff"></circle><circle cx="18" cy="20" r="1" fill="#fff"></circle></svg>
  </div>
  <div class="fc-info">
    <div class="fc-count" id="fc-count">0 –ø–æ–∑.</div>
    <div class="fc-total" id="fc-total">0 ‚ÇΩ</div>
  </div>
</div>

<!-- Mobile search FAB -->
<div class="search-fab" id="search-fab">
  <div class="fab-btn" id="fab-open" title="–ü–æ–∏—Å–∫">
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="#2E2E2E" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="#2E2E2E" stroke-width="1.6"/></svg>
  </div>
</div>

<div class="search-panel" id="search-panel" aria-hidden="true">
  <div style="display:flex;gap:8px;align-items:center">
    <input id="mobile-search-input" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." style="flex:1;padding:8px;border-radius:8px;border:1px solid var(--border);font-size:14px">
    <button id="close-search-panel" style="background:transparent;border:0;cursor:pointer;font-size:18px">‚úï</button>
  </div>
  <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
    <select id="mobile-sort" style="padding:8px;border-radius:8px;border:1px solid var(--border);background:#fff;font-size:13px">
      <option value="default">–°–æ—Ä—Ç</option>
      <option value="price_asc">–¶–µ–Ω–∞ ‚Üë</option>
      <option value="price_desc">–¶–µ–Ω–∞ ‚Üì</option>
      <option value="name_asc">A ‚Üí –Ø</option>
      <option value="name_desc">–Ø ‚Üí A</option>
    </select>
    <div style="flex:1"></div>
  </div>
</div>

<!-- product modal -->
<div id="product-modal" class="product-modal" aria-hidden="true">
  <div class="panel">
    <button id="product-modal-close" style="float:right;background:transparent;border:0;font-size:20px;cursor:pointer">‚úï</button>
    <div class="pm-top">
      <img id="pm-img" class="pm-img" src="images/noimage.png" alt="–§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞">
      <div style="flex:1">
        <h3 id="pm-name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
        <div id="pm-price" style="font-weight:800;margin-bottom:6px;"></div>
        <div class="kbju-label">–í 100 –≥—Ä–∞–º–º–∞—Ö</div>
        <div class="kbju" id="pm-kbju">–ö–ë–ñ–£: ‚Äî</div>
      </div>
    </div>

    <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
      <input id="pm-qty" class="qty-input" type="number" min="1" step="1" value="1" style="width:80px">
      <select id="pm-unit" class="unit-select" style="padding:6px;border-radius:8px;border:1px solid var(--border)">
        <option value="kg">–∫–≥</option>
        <option value="g">–≥—Ä</option>
      </select>
      <button id="pm-add" class="add-to-cart" style="margin-left:auto;padding:8px 12px">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
    </div>

    <div style="margin-top:12px">
      <button id="pm-more" class="custom-btn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ç–æ–≤–∞—Ä–µ</button>
      <div id="pm-desc" class="prod-desc" style="display:none"></div>
    </div>
  </div>
</div>

<!-- checkout modal -->
<div id="modal" class="modal" aria-hidden="true">
  <div class="panel">
    <h3 style="font-family:'Montserrat',Arial;margin:0 0 8px">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
    <div style="display:flex;gap:14px;flex-wrap:wrap">
      <div style="flex:1;min-width:220px">
        <div style="font-weight:700;margin-bottom:8px">–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞</div>
        <div id="modal-order-list" style="max-height:300px;overflow:auto;border:1px solid var(--border);padding:8px;border-radius:8px;background:#fff"></div>
        <div style="margin-top:10px;font-weight:800;display:flex;justify-content:space-between"><div>–ò—Ç–æ–≥–æ</div><div id="modal-total">0 ‚ÇΩ</div></div>
      </div>
      <div style="flex:1;min-width:220px">
        <form id="order-form">
          <div class="form-row"><label>–ò–º—è *</label><input id="cust-name" required></div>
          <div class="form-row"><label>–¢–µ–ª–µ—Ñ–æ–Ω *</label><input id="cust-phone" required></div>
          <div class="form-row"><label>–ì–æ—Ä–æ–¥ *</label><input id="cust-city" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ—Å–∫–≤–∞"></div>
          <div class="form-row"><label>–£–ª–∏—Ü–∞ *</label><input id="cust-street" required></div>
          <div class="form-row" style="display:flex;gap:8px"><div style="flex:1"><label>–î–æ–º *</label><input id="cust-house" required></div><div style="flex:1"><label>–ö–≤–∞—Ä—Ç–∏—Ä–∞</label><input id="cust-apartment"></div></div>
          <div class="form-row"><label>–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
            <select id="delivery-time"><option value="asap">–ö–∞–∫ –º–æ–∂–Ω–æ —Å–∫–æ—Ä–µ–µ</option><option value="custom">–£–∫–∞–∑–∞—Ç—å –≤—Ä–µ–º—è</option></select>
            <input type="time" id="custom-time" style="display:none;margin-top:8px"></div>
          <div class="form-row"><label>–ü–æ—á—Ç–∞ –¥–ª—è —á–µ–∫–∞</label><input id="cust-email" type="email"></div>
          <div class="form-row"><label>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã *</label><select id="payment-method"><option value="cash">–ù–∞–ª–∏—á–Ω—ã–µ</option><option value="card">–ö–∞—Ä—Ç–∞</option></select></div>
          <div class="form-actions" style="margin-top:12px">
            <button type="button" id="close-modal" class="btn btn-clear">–û—Ç–º–µ–Ω–∞</button>
            <button type="submit" class="btn btn-check">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- auth modal -->
<div id="auth-modal" class="product-modal" aria-hidden="true" style="z-index:1200">
  <div class="panel">
    <button id="auth-close" style="float:right;background:transparent;border:0;font-size:20px;cursor:pointer">‚úï</button>
    <h3>–í–æ–π—Ç–∏ –≤ Bravo Market</h3>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px">
      <button id="auth-tg" class="pill" style="padding:10px 14px">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram</button>
      <div style="flex:1;min-width:200px">
        <label style="font-weight:700;font-size:13px;display:block;margin-bottom:6px">–í–æ–π—Ç–∏ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label>
        <div style="display:flex;gap:8px">
          <input id="auth-phone" placeholder="+7..." style="flex:1;padding:8px;border-radius:8px;border:1px solid var(--border)">
          <button id="auth-phone-btn" class="add-to-cart" style="padding:8px 10px">–í–æ–π—Ç–∏</button>
        </div>
        <div style="font-size:13px;color:var(--muted);margin-top:6px">–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∏ SMS.</div>
      </div>
    </div>
  </div>
</div>

<footer class="footer" style="padding:20px;text-align:center;color:var(--muted)">¬© Bravo Market ‚Äî –°–≤–µ–∂–µ—Å—Ç—å, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å.</footer>

<script>
/* ================== CONFIG ==================
 Replace ADMIN_WEBHOOK_URL with your server endpoint to receive order notifications.
 For Telegram login within WebApp the code tries to use window.Telegram.WebApp.initDataUnsafe
=============================================*/
const ADMIN_WEBHOOK_URL = ""; // <-- PUT YOUR ADMIN WEBHOOK URL HERE (POST)

/* Telegram fallback object (WebApp) */
const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;

/* ========== Products (array format) ========== */
const products = [
  ["üçâ –ê—Ä–±—É–∑ ‚Äî 40‚ÇΩ/–∫–≥", "–ê—Ä–±—É–∑", 40, "fruits"],
  ["üçê –ì—Ä—É—à–∞ ‚Äî 340‚ÇΩ/–∫–≥", "–ì—Ä—É—à–∞", 340, "fruits"],
  ["üçä –ê–ø–µ–ª—å—Å–∏–Ω ‚Äî 220‚ÇΩ/–∫–≥", "–ê–ø–µ–ª—å—Å–∏–Ω", 220, "fruits"],
  ["üçà –î—ã–Ω—è —Ç–æ—Ä–ø–µ–¥–∞ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω ‚Äî 80‚ÇΩ/–∫–≥", "–î—ã–Ω—è —Ç–æ—Ä–ø–µ–¥–∞ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω", 80, "fruits"],
  ["üçà –î—ã–Ω—è –∫–æ–ª—Ö–æ–∑–Ω–∏—Ü–∞ ‚Äî 80‚ÇΩ/–∫–≥", "–î—ã–Ω—è –∫–æ–ª—Ö–æ–∑–Ω–∏—Ü–∞", 80, "fruits"],
  ["üçá –í–∏–Ω–æ–≥—Ä–∞–¥ –∑–µ–ª–µ–Ω—ã–π (–±–µ–∑ –∫–æ—Å—Ç–æ—á–µ–∫) ‚Äî 320‚ÇΩ/–∫–≥", "–í–∏–Ω–æ–≥—Ä–∞–¥ –∑–µ–ª–µ–Ω—ã–π (–±–µ–∑ –∫–æ—Å—Ç–æ—á–µ–∫)", 320, "fruits"],
  ["üçá –í–∏–Ω–æ–≥—Ä–∞–¥ —Ç–µ–º–Ω—ã–π (–±–µ–∑ –∫–æ—Å—Ç–æ—á–µ–∫) ‚Äî 320‚ÇΩ/–∫–≥", "–í–∏–Ω–æ–≥—Ä–∞–¥ —Ç–µ–º–Ω—ã–π (–±–µ–∑ –∫–æ—Å—Ç–æ—á–µ–∫)", 320, "fruits"],
  ["üçá –í–∏–Ω–æ–≥—Ä–∞–¥ —á–µ—Ä–Ω—ã–π (–ú–µ—Ä—Å–µ–¥–µ—Å) ‚Äî 300‚ÇΩ/–∫–≥", "–í–∏–Ω–æ–≥—Ä–∞–¥ —á–µ—Ä–Ω—ã–π (–ú–µ—Ä—Å–µ–¥–µ—Å)", 300, "fruits"],
  ["üçë –ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∫—Ä–∞—Å–Ω—ã–π ‚Äî 170‚ÇΩ/–∫–≥", "–ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∫—Ä–∞—Å–Ω—ã–π", 170, "fruits"],
  ["üçë –ù–µ–∫—Ç–∞—Ä–∏–Ω –¢—É—Ä—Ü–∏—è ‚Äî 350‚ÇΩ/–∫–≥", "–ù–µ–∫—Ç–∞—Ä–∏–Ω –¢—É—Ä—Ü–∏—è", 350, "fruits"],
  ["üçë –ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∂–µ–ª—Ç—ã–π (–≤–∫—É—Å –ª–∏–º–æ–Ω) ‚Äî 250‚ÇΩ/–∫–≥", "–ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∂–µ–ª—Ç—ã–π (–≤–∫—É—Å –ª–∏–º–æ–Ω)", 250, "fruits"],
  ["üçë –ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∑–µ–ª–µ–Ω—ã–π ‚Äî 190‚ÇΩ/–∫–≥", "–ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∑–µ–ª–µ–Ω—ã–π", 190, "fruits"],
  ["üçå –ë–∞–Ω–∞–Ω ‚Äî 170‚ÇΩ/–∫–≥", "–ë–∞–Ω–∞–Ω", 170, "fruits"],
  ["ü•î –ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ß—É–≤–∞—à–∏—è ‚Äî 45‚ÇΩ/–∫–≥", "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ß—É–≤–∞—à–∏—è", 45, "vegetables"],
  ["ü•î –ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä ‚Äî 45‚ÇΩ/–∫–≥", "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä", 45, "vegetables"],
  ["ü•ï –ú–æ—Ä–∫–æ–≤—å –í–æ–ª–≥–æ–≥—Ä–∞–¥ ‚Äî 45‚ÇΩ/–∫–≥", "–ú–æ—Ä–∫–æ–≤—å –í–æ–ª–≥–æ–≥—Ä–∞–¥", 45, "vegetables"],
  ["üßÖ –õ—É–∫ —Ä–µ–ø—á–∞—Ç—ã–π –í–æ–ª–≥–æ–≥—Ä–∞–¥ ‚Äî 45‚ÇΩ/–∫–≥", "–õ—É–∫ —Ä–µ–ø—á–∞—Ç—ã–π –í–æ–ª–≥–æ–≥—Ä–∞–¥", 45, "vegetables"],
  ["üå± –õ—É–∫ –∑–µ–ª–µ–Ω—ã–π ‚Äî 350‚ÇΩ/–∫–≥", "–õ—É–∫ –∑–µ–ª–µ–Ω—ã–π", 350, "vegetables"],
  ["üå± –£–∫—Ä–æ–ø, –ø–µ—Ç—Ä—É—à–∫–∞ ‚Äî 350‚ÇΩ/–∫–≥", "–£–∫—Ä–æ–ø, –ø–µ—Ç—Ä—É—à–∫–∞", 350, "vegetables"],
  ["üå± –ö–∏–Ω–∑–∞ ‚Äî 440‚ÇΩ/–∫–≥", "–ö–∏–Ω–∑–∞", 440, "vegetables"],
  ["üå± –ë–∞–∑–µ–ª–∏–∫ ‚Äî 50‚ÇΩ/–ø—É—á–æ–∫", "–ë–∞–∑–µ–ª–∏–∫ (–ø—É—á–æ–∫)", 50, "vegetables"],
  ["üßÑ –ß–µ—Å–Ω–æ–∫ –¢–∞—à–∫–µ–Ω—Ç ‚Äî 400‚ÇΩ/–∫–≥", "–ß–µ—Å–Ω–æ–∫ –¢–∞—à–∫–µ–Ω—Ç", 400, "vegetables"],
  ["ü´ë –ü–µ—Ä–µ—Ü –±–æ–ª–≥–∞—Ä—Å–∫–∏–π ‚Äî 130‚ÇΩ/–∫–≥", "–ü–µ—Ä–µ—Ü –±–æ–ª–≥–∞—Ä—Å–∫–∏–π", 130, "vegetables"],
  ["üå∂Ô∏è –ü–µ—Ä–µ—Ü —á–∏–ª–∏ ‚Äî 25‚ÇΩ/—à—Ç", "–ü–µ—Ä–µ—Ü —á–∏–ª–∏", 25, "vegetables"],
  ["üçÖ –ü–æ–º–∏–¥–æ—Ä—ã –ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω—Å–∫–∏–µ ‚Äî 220‚ÇΩ/–∫–≥", "–ü–æ–º–∏–¥–æ—Ä—ã –ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω—Å–∫–∏–µ", 220, "vegetables"],
  ["üçÖ –ü–æ–º–∏–¥–æ—Ä—ã –†–æ—Å—Ç–æ–≤—Å–∫–∏–µ ‚Äî 180‚ÇΩ/–∫–≥", "–ü–æ–º–∏–¥–æ—Ä—ã –†–æ—Å—Ç–æ–≤—Å–∫–∏–µ", 180, "vegetables"],
  ["üçÖ –ü–æ–º–∏–¥–æ—Ä—ã –í–æ–ª–≥–æ–≥—Ä–∞–¥ (–º–µ–ª–∫–∏–µ) ‚Äî 80‚ÇΩ/–∫–≥", "–ü–æ–º–∏–¥–æ—Ä—ã –í–æ–ª–≥–æ–≥—Ä–∞–¥ (–º–µ–ª–∫–∏–µ)", 80, "vegetables"],
  ["üçÖ –ü–æ–º–∏–¥–æ—Ä—ã –¥–æ–º–∞—à–Ω–∏–µ ‚Äî 240‚ÇΩ/–∫–≥", "–ü–æ–º–∏–¥–æ—Ä—ã –¥–æ–º–∞—à–Ω–∏–µ", 240, "vegetables"],
  ["üçÖ –ü–æ–º–∏–¥–æ—Ä—ã –ê—Å—Ç—Ä–∞—Ö–∞–Ω—å (–∂–µ–ª—Ç—ã–µ) ‚Äî 190‚ÇΩ/–∫–≥", "–ü–æ–º–∏–¥–æ—Ä—ã –ê—Å—Ç—Ä–∞—Ö–∞–Ω—å (–∂–µ–ª—Ç—ã–µ)", 190, "vegetables"],
  ["ü•í –û–≥—É—Ä—Ü—ã –ú–æ—Å–∫–æ–≤—Å–∫–∏–µ ‚Äî 150‚ÇΩ/–∫–≥", "–û–≥—É—Ä—Ü—ã –ú–æ—Å–∫–æ–≤—Å–∫–∏–µ", 150, "vegetables"],
  ["ü•í –û–≥—É—Ä—Ü—ã –°–∞–º–∞—Ä—Å–∫–∏–µ ‚Äî 80‚ÇΩ/–∫–≥", "–û–≥—É—Ä—Ü—ã –°–∞–º–∞—Ä—Å–∫–∏–µ", 80, "vegetables"],
  ["ü•í –û–≥—É—Ä—Ü—ã –¥–æ–º–∞—à–Ω–∏–µ ‚Äî 150‚ÇΩ/–∫–≥", "–û–≥—É—Ä—Ü—ã –¥–æ–º–∞—à–Ω–∏–µ", 150, "vegetables"],
  ["üçë –°–ª–∏–≤–∞ 4 –≤–∏–¥–∞ ‚Äî 190‚ÇΩ/–∫–≥ - –¢–∞—à–∫–µ–Ω—Ç; –ú–µ–¥–æ–≤–∞—è - 220‚ÇΩ/–∫–≥; –ñ–µ–ª—Ç–∞—è - 250‚ÇΩ/–∫–≥; –ß–µ—Ä–Ω–æ—Å–ª–∏–≤–∞ - 220‚ÇΩ/–∫–≥", "–°–ª–∏–≤–∞ 4 –≤–∏–¥–∞", 220, "fruits"],
  ["üçí –ß–µ—Ä–µ—à–Ω—è ‚Äî 580‚ÇΩ/–∫–≥", "–ß–µ—Ä–µ—à–Ω—è", 580, "fruits"],
  ["ü´ê –ì–æ–ª—É–±–∏–∫–∞ ‚Äî 800‚ÇΩ/–∫–≥", "–ì–æ–ª—É–±–∏–∫–∞", 800, "fruits"],
  ["üçë –ê–±—Ä–∏–∫–æ—Å –ê—Ä–º–µ–Ω–∏—è ‚Äî 240‚ÇΩ/–∫–≥", "–ê–±—Ä–∏–∫–æ—Å –ê—Ä–º–µ–Ω–∏—è", 240, "fruits"],
  ["üçë –ê–±—Ä–∏–∫–æ—Å –ö–∏—Ä–≥–∏–∑–∏—è ‚Äî 150‚ÇΩ/–∫–≥", "–ê–±—Ä–∏–∫–æ—Å –ö–∏—Ä–≥–∏–∑–∏—è", 150, "fruits"],
  ["üçë –ü–µ—Ä—Å–∏–∫ –¢–∞—à–∫–µ–Ω—Ç ‚Äî 250‚ÇΩ/–∫–≥", "–ü–µ—Ä—Å–∏–∫ –¢–∞—à–∫–µ–Ω—Ç", 250, "fruits"],
  ["üçë –ü–µ—Ä—Å–∏–∫ –ê—Ä–º–µ–Ω–∏—è ‚Äî 380‚ÇΩ/–∫–≥", "–ü–µ—Ä—Å–∏–∫ –ê—Ä–º–µ–Ω–∏—è", 380, "fruits"],
  ["üçë –ü–µ—Ä—Å–∏–∫ –¢—É—Ä—Ü–∏—è ‚Äî 450‚ÇΩ/–∫–≥", "–ü–µ—Ä—Å–∏–∫ –¢—É—Ä—Ü–∏—è", 450, "fruits"],
  ["üçë –ü–µ—Ä—Å–∏–∫ –ò–Ω–∂–∏—Ä–Ω—ã–π ‚Äî 350‚ÇΩ/–∫–≥", "–ü–µ—Ä—Å–∏–∫ –ò–Ω–∂–∏—Ä–Ω—ã–π", 350, "fruits"],
  ["ü•ù –ö–∏–≤–∏ ‚Äî 450‚ÇΩ/–∫–≥", "–ö–∏–≤–∏", 450, "fruits"],
  ["–ö–∞–±–∞—á–æ–∫ ‚Äî 55‚ÇΩ/–∫–≥", "–ö–∞–±–∞—á–æ–∫", 55, "vegetables"],
  ["üçÜ –ë–∞–∫–ª–∞–∂–∞–Ω ‚Äî 130‚ÇΩ/–∫–≥", "–ë–∞–∫–ª–∞–∂–∞–Ω", 130, "vegetables"],
  ["üçã –õ–∏–º–æ–Ω ‚Äî 290‚ÇΩ/–∫–≥", "–õ–∏–º–æ–Ω", 290, "fruits"]
];

/* KBJU and descriptions */
const kbjuData = {
  "–ê—Ä–±—É–∑": { kbju: "30 –∫–∫–∞–ª ‚Ä¢ –ë 0.6 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 7.6 –≥", desc: "üíö –û—Å–≤–µ–∂–∞—é—â–∏–π –∏ –±–æ–≥–∞—Ç—ã–π –ª–∏–∫–æ–ø–∏–Ω–æ–º —Ñ—Ä—É–∫—Ç, –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å —Ç–æ–∫—Å–∏–Ω—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–æ–¥–Ω—ã–π –±–∞–ª–∞–Ω—Å." },
  "–ì—Ä—É—à–∞": { kbju: "57 –∫–∫–∞–ª ‚Ä¢ –ë 0.4 –≥ ‚Ä¢ –ñ 0.4 –≥ ‚Ä¢ –£ 15 –≥", desc: "üçê –û—Ç–ª–∏—á–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∫–ª–µ—Ç—á–∞—Ç–∫–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–¥–æ—Ä–æ–≤–æ–µ –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ –∏ —Å–Ω–∏–∂–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞." },
  "–ê–ø–µ–ª—å—Å–∏–Ω": { kbju: "47 –∫–∫–∞–ª ‚Ä¢ –ë 0.9 –≥ ‚Ä¢ –ñ 0.1 –≥ ‚Ä¢ –£ 11.8 –≥", desc: "üçä –ú–æ—â–Ω—ã–π –∑–∞—Ä—è–¥ –≤–∏—Ç–∞–º–∏–Ω–∞ C, —É–∫—Ä–µ–ø–ª—è–µ—Ç –∏–º–º—É–Ω–∏—Ç–µ—Ç –∏ –ø–æ–≤—ã—à–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å —ç–Ω–µ—Ä–≥–∏–∏." },
  "–î—ã–Ω—è —Ç–æ—Ä–ø–µ–¥–∞ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω": { kbju: "35 –∫–∫–∞–ª ‚Ä¢ –ë 0.8 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 8 –≥", desc: "üçà –û—Å–≤–µ–∂–∞—é—â–∞—è, –Ω–∞—Å—ã—â–µ–Ω–∞ –∫–∞–ª–∏–µ–º –∏ –≤–∏—Ç–∞–º–∏–Ω–æ–º C, —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –¥–µ—Ç–æ–∫—Å–∏–∫–∞—Ü–∏–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–∞." },
  "–î—ã–Ω—è –∫–æ–ª—Ö–æ–∑–Ω–∏—Ü–∞": { kbju: "36 –∫–∫–∞–ª ‚Ä¢ –ë 0.6 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 8.1 –≥", desc: "üçà –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–æ–¥–Ω—ã–π –±–∞–ª–∞–Ω—Å, –º—è–≥–∫–æ —É–ª—É—á—à–∞–µ—Ç –æ–±–º–µ–Ω –≤–µ—â–µ—Å—Ç–≤." },
  "–í–∏–Ω–æ–≥—Ä–∞–¥ –∑–µ–ª–µ–Ω—ã–π (–±–µ–∑ –∫–æ—Å—Ç–æ—á–µ–∫)": { kbju: "69 –∫–∫–∞–ª ‚Ä¢ –ë 0.7 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 18 –≥", desc: "üçá –ò—Å—Ç–æ—á–Ω–∏–∫ –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç–æ–≤, —É–∫—Ä–µ–ø–ª—è–µ—Ç —Å–µ—Ä–¥—Ü–µ –∏ —Å–æ—Å—É–¥—ã." },
  "–í–∏–Ω–æ–≥—Ä–∞–¥ —Ç–µ–º–Ω—ã–π (–±–µ–∑ –∫–æ—Å—Ç–æ—á–µ–∫)": { kbju: "70 –∫–∫–∞–ª ‚Ä¢ –ë 0.6 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 18 –≥", desc: "üçá –°–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ—Å–≤–µ—Ä–∞—Ç—Ä–æ–ª ‚Äî –º–æ—â–Ω—ã–π –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç –¥–ª—è –º–æ–ª–æ–¥–æ—Å—Ç–∏ –∫–æ–∂–∏ –∏ —Å–æ—Å—É–¥–æ–≤." },
  "–í–∏–Ω–æ–≥—Ä–∞–¥ —á–µ—Ä–Ω—ã–π (–ú–µ—Ä—Å–µ–¥–µ—Å)": { kbju: "72 –∫–∫–∞–ª ‚Ä¢ –ë 0.7 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 17 –≥", desc: "üçá –ë–ª–∞–≥–æ—Ç–≤–æ—Ä–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–µ—Ä–¥—Ü–µ –∏ –∏–º–º—É–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É." },
  "–ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∫—Ä–∞—Å–Ω—ã–π": { kbju: "44 –∫–∫–∞–ª ‚Ä¢ –ë 1.1 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 10 –≥", desc: "üçë –ë–æ–≥–∞—Ç –≤–∏—Ç–∞–º–∏–Ω–æ–º A –∏ –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç–∞–º–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ –∫–æ–∂–∏." },
  "–ù–µ–∫—Ç–∞—Ä–∏–Ω –¢—É—Ä—Ü–∏—è": { kbju: "45 –∫–∫–∞–ª ‚Ä¢ –ë 1 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 10 –≥", desc: "üçë –£–ª—É—á—à–∞–µ—Ç –æ–±–º–µ–Ω –≤–µ—â–µ—Å—Ç–≤ –∏ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –∑–¥–æ—Ä–æ–≤–æ–º—É –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏—é." },
  "–ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∂–µ–ª—Ç—ã–π (–≤–∫—É—Å –ª–∏–º–æ–Ω)": { kbju: "45 –∫–∫–∞–ª ‚Ä¢ –ë 1 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 10 –≥", desc: "üçë –°–æ—á–Ω—ã–π –∏ –∞—Ä–æ–º–∞—Ç–Ω—ã–π —Ñ—Ä—É–∫—Ç, —É–∫—Ä–µ–ø–ª—è–µ—Ç –∏–º–º—É–Ω–∏—Ç–µ—Ç –∏ –ø—Ä–∏–¥–∞—ë—Ç —ç–Ω–µ—Ä–≥–∏–∏." },
  "–ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∑–µ–ª–µ–Ω—ã–π": { kbju: "44 –∫–∫–∞–ª ‚Ä¢ –ë 1.1 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 10 –≥", desc: "üçë –û—Å–≤–µ–∂–∞–µ—Ç –∏ –ø–æ–º–æ–≥–∞–µ—Ç –æ—á–∏—â–∞—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–º." },
  "–ë–∞–Ω–∞–Ω": { kbju: "89 –∫–∫–∞–ª ‚Ä¢ –ë 1.1 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 23 –≥", desc: "üçå –ò—Å—Ç–æ—á–Ω–∏–∫ –∫–∞–ª–∏—è –∏ –º–∞–≥–Ω–∏—è ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–µ—Ä–¥—Ü–µ –∏ –Ω–µ—Ä–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É." },
  "–°–ª–∏–≤–∞ 4 –≤–∏–¥–∞": { kbju: "46 –∫–∫–∞–ª ‚Ä¢ –ë 0.7 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 11 –≥", desc: "üçë –ü–æ–º–æ–≥–∞–µ—Ç –æ—á–∏—â–∞—Ç—å –∫–∏—à–µ—á–Ω–∏–∫, –±–æ–≥–∞—Ç–∞ –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç–∞–º–∏ –∏ –≤–∏—Ç–∞–º–∏–Ω–æ–º C." },
  "–ß–µ—Ä–µ—à–Ω—è": { kbju: "63 –∫–∫–∞–ª ‚Ä¢ –ë 1.1 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 16 –≥", desc: "üçí –£–∫—Ä–µ–ø–ª—è–µ—Ç —Å–æ—Å—É–¥—ã, —É–ª—É—á—à–∞–µ—Ç —Å–æ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ." },
  "–ì–æ–ª—É–±–∏–∫–∞": { kbju: "57 –∫–∫–∞–ª ‚Ä¢ –ë 0.7 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 14 –≥", desc: "ü´ê –û–¥–∏–Ω –∏–∑ –ª—É—á—à–∏—Ö –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç–æ–≤, —É–ª—É—á—à–∞–µ—Ç –ø–∞–º—è—Ç—å –∏ –∑—Ä–µ–Ω–∏–µ." },
  "–ê–±—Ä–∏–∫–æ—Å –ê—Ä–º–µ–Ω–∏—è": { kbju: "48 –∫–∫–∞–ª ‚Ä¢ –ë 1.4 –≥ ‚Ä¢ –ñ 0.4 –≥ ‚Ä¢ –£ 11 –≥", desc: "üçë –ë–æ–≥–∞—Ç –±–µ—Ç–∞-–∫–∞—Ä–æ—Ç–∏–Ω–æ–º, —É–ª—É—á—à–∞–µ—Ç –∑—Ä–µ–Ω–∏–µ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–∂–∏." },
  "–ê–±—Ä–∏–∫–æ—Å –ö–∏—Ä–≥–∏–∑–∏—è": { kbju: "48 –∫–∫–∞–ª ‚Ä¢ –ë 1.4 –≥ ‚Ä¢ –ñ 0.4 –≥ ‚Ä¢ –£ 11 –≥", desc: "üçë –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –ø–µ—á–µ–Ω–∏ –∏ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –≤—ã—Ä–∞–±–æ—Ç–∫–µ –∫–æ–ª–ª–∞–≥–µ–Ω–∞." },
  "–ü–µ—Ä—Å–∏–∫ –¢–∞—à–∫–µ–Ω—Ç": { kbju: "39 –∫–∫–∞–ª ‚Ä¢ –ë 0.9 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 10 –≥", desc: "üçë –ü–æ–º–æ–≥–∞–µ—Ç –æ—á–∏—â–µ–Ω–∏—é –æ—Ä–≥–∞–Ω–∏–∑–º–∞ –∏ —É–∫—Ä–µ–ø–ª—è–µ—Ç –∏–º–º—É–Ω–∏—Ç–µ—Ç." },
  "–ü–µ—Ä—Å–∏–∫ –ê—Ä–º–µ–Ω–∏—è": { kbju: "39 –∫–∫–∞–ª ‚Ä¢ –ë 0.9 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 10 –≥", desc: "üçë –ò—Å—Ç–æ—á–Ω–∏–∫ –≤–∏—Ç–∞–º–∏–Ω–æ–≤ A –∏ E, —É–ª—É—á—à–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–∂–∏ –∏ –≤–æ–ª–æ—Å." },
  "–ü–µ—Ä—Å–∏–∫ –¢—É—Ä—Ü–∏—è": { kbju: "39 –∫–∫–∞–ª ‚Ä¢ –ë 0.9 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 10 –≥", desc: "üçë –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–º–µ–Ω –≤–µ—â–µ—Å—Ç–≤ –∏ –≤–æ—Å–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø–∞—Å—ã –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç–æ–≤." },
  "–ü–µ—Ä—Å–∏–∫ –ò–Ω–∂–∏—Ä–Ω—ã–π": { kbju: "40 –∫–∫–∞–ª ‚Ä¢ –ë 0.9 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 10 –≥", desc: "üçë –°–ª–∞–¥–∫–∏–π –∏ –Ω–µ–∂–Ω—ã–π, –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏ —É—Å—Ç–∞–ª–æ—Å—Ç–∏ –∏ —Å—Ç—Ä–µ—Å—Å–∞—Ö." },
  "–ö–∏–≤–∏": { kbju: "41 –∫–∫–∞–ª ‚Ä¢ –ë 1.1 –≥ ‚Ä¢ –ñ 0.5 –≥ ‚Ä¢ –£ 10 –≥", desc: "ü•ù –°–æ–¥–µ—Ä–∂–∏—Ç –±–æ–ª—å—à–µ –≤–∏—Ç–∞–º–∏–Ω–∞ C, —á–µ–º –∞–ø–µ–ª—å—Å–∏–Ω, —É–∫—Ä–µ–ø–ª—è–µ—Ç –∏–º–º—É–Ω–∏—Ç–µ—Ç –∏ —É–ª—É—á—à–∞–µ—Ç –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ." },
  "–õ–∏–º–æ–Ω": { kbju: "29 –∫–∫–∞–ª ‚Ä¢ –ë 1.1 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 9 –≥", desc: "üçã –ú–æ—â–Ω—ã–π –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç, –æ—á–∏—â–∞–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–º –∏ —É–ª—É—á—à–∞–µ—Ç –æ–±–º–µ–Ω –≤–µ—â–µ—Å—Ç–≤." },
  "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ß—É–≤–∞—à–∏—è": { kbju: "77 –∫–∫–∞–ª ‚Ä¢ –ë 2 –≥ ‚Ä¢ –ñ 0.1 –≥ ‚Ä¢ –£ 17 –≥", desc: "ü•î –ò—Å—Ç–æ—á–Ω–∏–∫ –∫–∞–ª–∏—è –∏ –≤–∏—Ç–∞–º–∏–Ω–∞ B6, –¥–∞—ë—Ç —ç–Ω–µ—Ä–≥–∏—é –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Ä–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É." },
  "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä": { kbju: "77 –∫–∫–∞–ª ‚Ä¢ –ë 2 –≥ ‚Ä¢ –ñ 0.1 –≥ ‚Ä¢ –£ 17 –≥", desc: "ü•î –ü–æ–ª–µ–∑–µ–Ω –ø—Ä–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö, —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª–µ—Ç—á–∞—Ç–∫—É –∏ –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç—ã." },
  "–ú–æ—Ä–∫–æ–≤—å –í–æ–ª–≥–æ–≥—Ä–∞–¥": { kbju: "41 –∫–∫–∞–ª ‚Ä¢ –ë 0.9 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 10 –≥", desc: "ü•ï –ë–æ–≥–∞—Ç–∞ –±–µ—Ç–∞-–∫–∞—Ä–æ—Ç–∏–Ω–æ–º, —É–ª—É—á—à–∞–µ—Ç –∑—Ä–µ–Ω–∏–µ –∏ —É–∫—Ä–µ–ø–ª—è–µ—Ç –∫–æ–∂—É." },
  "–õ—É–∫ —Ä–µ–ø—á–∞—Ç—ã–π –í–æ–ª–≥–æ–≥—Ä–∞–¥": { kbju: "40 –∫–∫–∞–ª ‚Ä¢ –ë 1.1 –≥ ‚Ä¢ –ñ 0.1 –≥ ‚Ä¢ –£ 9.3 –≥", desc: "üßÖ –ü–æ–≤—ã—à–∞–µ—Ç –∏–º–º—É–Ω–∏—Ç–µ—Ç, –æ–±–ª–∞–¥–∞–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ–º–∏–∫—Ä–æ–±–Ω—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏." },
  "–õ—É–∫ –∑–µ–ª–µ–Ω—ã–π": { kbju: "32 –∫–∫–∞–ª ‚Ä¢ –ë 1.8 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 7.3 –≥", desc: "üå± –ò—Å—Ç–æ—á–Ω–∏–∫ –≤–∏—Ç–∞–º–∏–Ω–∞ C, –∂–µ–ª–µ–∑–∞ –∏ –∫–∞–ª—å—Ü–∏—è, –ø–æ–º–æ–≥–∞–µ—Ç —É–∫—Ä–µ–ø–∏—Ç—å –∫–æ—Å—Ç–∏." },
  "–£–∫—Ä–æ–ø, –ø–µ—Ç—Ä—É—à–∫–∞": { kbju: "43 –∫–∫–∞–ª ‚Ä¢ –ë 3 –≥ ‚Ä¢ –ñ 0.4 –≥ ‚Ä¢ –£ 8 –≥", desc: "üå± –£–ª—É—á—à–∞—é—Ç –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ, –æ—Å–≤–µ–∂–∞—é—Ç –¥—ã—Ö–∞–Ω–∏–µ –∏ —Å–Ω–∞–±–∂–∞—é—Ç –æ—Ä–≥–∞–Ω–∏–∑–º –≤–∏—Ç–∞–º–∏–Ω–∞–º–∏." },
  "–ö–∏–Ω–∑–∞": { kbju: "23 –∫–∫–∞–ª ‚Ä¢ –ë 2.1 –≥ ‚Ä¢ –ñ 0.5 –≥ ‚Ä¢ –£ 3.7 –≥", desc: "üåø –°–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–∏—é —Ç—è–∂—ë–ª—ã—Ö –º–µ—Ç–∞–ª–ª–æ–≤ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–µ—Ç–æ–∫—Å–∏–∫–∞—Ü–∏—é –æ—Ä–≥–∞–Ω–∏–∑–º–∞." },
  "–ë–∞–∑–µ–ª–∏–∫ (–ø—É—á–æ–∫)": { kbju: "22 –∫–∫–∞–ª ‚Ä¢ –ë 3.2 –≥ ‚Ä¢ –ñ 0.6 –≥ ‚Ä¢ –£ 2.6 –≥", desc: "üåø –ë–æ–≥–∞—Ç —ç—Ñ–∏—Ä–Ω—ã–º–∏ –º–∞—Å–ª–∞–º–∏, —É–ª—É—á—à–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ." },
  "–ß–µ—Å–Ω–æ–∫ –¢–∞—à–∫–µ–Ω—Ç": { kbju: "149 –∫–∫–∞–ª ‚Ä¢ –ë 6.4 –≥ ‚Ä¢ –ñ 0.5 –≥ ‚Ä¢ –£ 33 –≥", desc: "üßÑ –ú–æ—â–Ω—ã–π –ø—Ä–∏—Ä–æ–¥–Ω—ã–π –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫, —É–∫—Ä–µ–ø–ª—è–µ—Ç –∏–º–º—É–Ω–∏—Ç–µ—Ç –∏ —Å–µ—Ä–¥—Ü–µ." },
  "–ü–µ—Ä–µ—Ü –±–æ–ª–≥–∞—Ä—Å–∫–∏–π": { kbju: "27 –∫–∫–∞–ª ‚Ä¢ –ë 1.3 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 6 –≥", desc: "ü´ë –û–¥–∏–Ω –∏–∑ –ª—É—á—à–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤–∏—Ç–∞–º–∏–Ω–∞ C, –ø–æ–≤—ã—à–∞–µ—Ç –∏–º–º—É–Ω–∏—Ç–µ—Ç –∏ —É–ª—É—á—à–∞–µ—Ç –∫–æ–∂—É." },
  "–ü–µ—Ä–µ—Ü —á–∏–ª–∏": { kbju: "40 –∫–∫–∞–ª ‚Ä¢ –ë 2 –≥ ‚Ä¢ –ñ 0.4 –≥ ‚Ä¢ –£ 9 –≥", desc: "üå∂Ô∏è –£–ª—É—á—à–∞–µ—Ç –æ–±–º–µ–Ω –≤–µ—â–µ—Å—Ç–≤ –∏ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —Å–∂–∏–≥–∞–Ω–∏—é –∫–∞–ª–æ—Ä–∏–π." },
  "–ü–æ–º–∏–¥–æ—Ä—ã –ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω—Å–∫–∏–µ": { kbju: "18 –∫–∫–∞–ª ‚Ä¢ –ë 0.9 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 3.9 –≥", desc: "üçÖ –ë–æ–≥–∞—Ç—ã –ª–∏–∫–æ–ø–∏–Ω–æ–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Å–µ—Ä–¥—Ü–µ –∏ –∑–∞—â–∏—â–∞—é—Ç –∫–ª–µ—Ç–∫–∏ –æ—Ç —Å—Ç–∞—Ä–µ–Ω–∏—è." },
  "–ü–æ–º–∏–¥–æ—Ä—ã –†–æ—Å—Ç–æ–≤—Å–∫–∏–µ": { kbju: "18 –∫–∫–∞–ª ‚Ä¢ –ë 0.9 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 3.9 –≥", desc: "üçÖ –û—Ç–ª–∏—á–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç–æ–≤ –∏ –≤–∏—Ç–∞–º–∏–Ω–∞ C." },
  "–ü–æ–º–∏–¥–æ—Ä—ã –í–æ–ª–≥–æ–≥—Ä–∞–¥ (–º–µ–ª–∫–∏–µ)": { kbju: "18 –∫–∫–∞–ª ‚Ä¢ –ë 0.9 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 3.9 –≥", desc: "üçÖ –£–ª—É—á—à–∞—é—Ç –æ–±–º–µ–Ω –≤–µ—â–µ—Å—Ç–≤ –∏ —É–∫—Ä–µ–ø–ª—è—é—Ç –∏–º–º—É–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É." },
  "–ü–æ–º–∏–¥–æ—Ä—ã –¥–æ–º–∞—à–Ω–∏–µ": { kbju: "18 –∫–∫–∞–ª ‚Ä¢ –ë 0.9 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 3.9 –≥", desc: "üçÖ –°–æ–¥–µ—Ä–∂–∞—Ç –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –ª–∏–∫–æ–ø–∏–Ω, –∑–∞—â–∏—â–∞—é—Ç –∫–ª–µ—Ç–∫–∏ –æ—Ç —Å—Ç–∞—Ä–µ–Ω–∏—è." },
  "–ü–æ–º–∏–¥–æ—Ä—ã –ê—Å—Ç—Ä–∞—Ö–∞–Ω—å (–∂–µ–ª—Ç—ã–µ)": { kbju: "20 –∫–∫–∞–ª ‚Ä¢ –ë 1 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 4 –≥", desc: "üçÖ –ú—è–≥—á–µ –ø–æ –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç–∏, –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –ª—é–¥–µ–π —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∂–µ–ª—É–¥–∫–æ–º." },
  "–û–≥—É—Ä—Ü—ã –ú–æ—Å–∫–æ–≤—Å–∫–∏–µ": { kbju: "15 –∫–∫–∞–ª ‚Ä¢ –ë 0.8 –≥ ‚Ä¢ –ñ 0.1 –≥ ‚Ä¢ –£ 3.6 –≥", desc: "ü•í –°–æ—Å—Ç–æ—è—Ç –Ω–∞ 95 % –∏–∑ –≤–æ–¥—ã, –æ—á–∏—â–∞—é—Ç –æ—Ä–≥–∞–Ω–∏–∑–º –∏ —É–ª—É—á—à–∞—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–∂–∏." },
  "–û–≥—É—Ä—Ü—ã –°–∞–º–∞—Ä—Å–∫–∏–µ": { kbju: "15 –∫–∫–∞–ª ‚Ä¢ –ë 0.8 –≥ ‚Ä¢ –ñ 0.1 –≥ ‚Ä¢ –£ 3.6 –≥", desc: "ü•í –ü–æ–º–æ–≥–∞—é—Ç –≤—ã–≤–µ—Å—Ç–∏ –ª–∏—à–Ω—é—é –∂–∏–¥–∫–æ—Å—Ç—å –∏ —Ç–æ–Ω–∏–∑–∏—Ä—É—é—Ç." },
  "–û–≥—É—Ä—Ü—ã –¥–æ–º–∞—à–Ω–∏–µ": { kbju: "15 –∫–∫–∞–ª ‚Ä¢ –ë 0.8 –≥ ‚Ä¢ –ñ 0.1 –≥ ‚Ä¢ –£ 3.6 –≥", desc: "ü•í –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –±–∞–ª–∞–Ω—Å –∂–∏–¥–∫–æ—Å—Ç–∏ –∏ —ç–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç–æ–≤ –≤ –æ—Ä–≥–∞–Ω–∏–∑–º–µ." },
  "–ö–∞–±–∞—á–æ–∫": { kbju: "24 –∫–∫–∞–ª ‚Ä¢ –ë 1.5 –≥ ‚Ä¢ –ñ 0.3 –≥ ‚Ä¢ –£ 4.6 –≥", desc: "ü•í –õ–µ–≥–∫–æ —É—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è, –±–æ–≥–∞—Ç –∫–ª–µ—Ç—á–∞—Ç–∫–æ–π –∏ –≤–∏—Ç–∞–º–∏–Ω–∞–º–∏ –≥—Ä—É–ø–ø—ã B." },
  "–ë–∞–∫–ª–∞–∂–∞–Ω": { kbju: "25 –∫–∫–∞–ª ‚Ä¢ –ë 1 –≥ ‚Ä¢ –ñ 0.2 –≥ ‚Ä¢ –£ 6 –≥", desc: "üçÜ –°–æ–¥–µ—Ä–∂–∏—Ç –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç—ã, —Å–Ω–∏–∂–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–µ—Ä–¥—Ü–µ." }
};

/* ========== state & refs ========== */
let cart = [];
let visibleProducts = products.slice();
let currentFilter = 'all';

const catalogEl = document.getElementById('catalog');
const shownCountEl = document.getElementById('shown-count');
const filtersWrap = document.getElementById('filters');
const searchInput = document.getElementById('search-input');
const sortSelect = document.getElementById('sort-select');

const mobileSearchInput = document.getElementById('mobile-search-input');
const mobileSort = document.getElementById('mobile-sort');
const searchPanel = document.getElementById('search-panel');
const fabOpen = document.getElementById('fab-open');
const closeSearchPanelBtn = document.getElementById('close-search-panel');

const floatingCart = document.getElementById('floating-cart');
const fcCountEl = document.getElementById('fc-count');
const fcTotalEl = document.getElementById('fc-total');

const cartPanel = document.getElementById('cart-panel');
const cartItemsEl = document.getElementById('cart-items');
const cartSumEl = document.getElementById('cart-sum');
const cartCountSmall = document.getElementById('cart-count-2');
const cartCloseBtn = document.getElementById('cart-close-btn');
const clearCartBtn = document.getElementById('clear-cart');
const gotoCheckoutBtn = document.getElementById('goto-checkout');

const checkoutModal = document.getElementById('modal');
const modalOrderList = document.getElementById('modal-order-list');
const modalTotal = document.getElementById('modal-total');
const orderForm = document.getElementById('order-form');
const deliveryTimeSelect = document.getElementById('delivery-time');
const customTimeInput = document.getElementById('custom-time');
const closeModalBtn = document.getElementById('close-modal');

const loyaltyBadge = document.getElementById('loyalty-badge');
const heroOrderBtn = document.getElementById('hero-order');
const viewCatalogBtn = document.getElementById('view-catalog');

const userAreaBtn = document.getElementById('user-area');
const uaName = document.getElementById('ua-name');

const productModal = document.getElementById('product-modal');
const pmImg = document.getElementById('pm-img');
const pmName = document.getElementById('pm-name');
const pmPrice = document.getElementById('pm-price');
const pmKbju = document.getElementById('pm-kbju');
const pmMore = document.getElementById('pm-more');
const pmDesc = document.getElementById('pm-desc');
const pmClose = document.getElementById('product-modal-close');
const pmQty = document.getElementById('pm-qty');
const pmUnit = document.getElementById('pm-unit');
const pmAdd = document.getElementById('pm-add');

const authModal = document.getElementById('auth-modal');
const authTg = document.getElementById('auth-tg');
const authClose = document.getElementById('auth-close');
const authPhone = document.getElementById('auth-phone');
const authPhoneBtn = document.getElementById('auth-phone-btn');

/* ========== simple user system (localStorage) ========== */
/* user object stored as JSON in localStorage under 'bm_user'
  { id, name, phone, tgUser } tgUser may contain tg id/username if available
  loyalty stored under 'bm_loyalty' as number (only for registered users)
*/
function getStoredUser(){ try { return JSON.parse(localStorage.getItem('bm_user')||'null'); } catch(e){ return null; } }
function storeUser(u){ localStorage.setItem('bm_user', JSON.stringify(u)); }
function clearUser(){ localStorage.removeItem('bm_user'); localStorage.removeItem('bm_loyalty'); updateUserUI(); }

function getLoyalty(){ return parseInt(localStorage.getItem('bm_loyalty')||'0',10); }
function setLoyalty(n){ localStorage.setItem('bm_loyalty', String(n)); updateUserUI(); }
function addLoyalty(n){ const cur = getLoyalty(); setLoyalty(cur + n); }

function updateUserUI(){
  const u = getStoredUser();
  if(u){
    uaName.textContent = u.name || (u.phone || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å');
    loyaltyBadge.textContent = '–ë–∞–ª–ª—ã: ' + getLoyalty();
  } else {
    uaName.textContent = '–í–æ–π—Ç–∏';
    loyaltyBadge.textContent = '–ë–∞–ª–ª—ã: 0';
  }
}

/* Try to auto-login from Telegram WebApp if available */
function tryTelegramLogin(){
  if(tg && tg.initDataUnsafe && tg.initDataUnsafe.user){
    const tu = tg.initDataUnsafe.user;
    const user = { id: 'tg_' + (tu.id||Math.random().toString(36).slice(2,8)), name: (tu.first_name || '') + (tu.last_name ? ' '+tu.last_name : ''), tgUser: tu };
    storeUser(user);
    // ensure loyalty exists
    if(!localStorage.getItem('bm_loyalty')) localStorage.setItem('bm_loyalty','0');
    updateUserUI();
    return true;
  }
  return false;
}

/* Auth UI wiring */
userAreaBtn.addEventListener('click', ()=> {
  // open auth modal
  authModal.style.display = 'flex';
  authModal.setAttribute('aria-hidden','false');
});
authClose.addEventListener('click', ()=> { authModal.style.display='none'; authModal.setAttribute('aria-hidden','true'); });

authTg.addEventListener('click', ()=> {
  // If running inside Telegram WebApp, ask user to use Telegram auth (here we only use initDataUnsafe)
  if(tryTelegramLogin()){
    alert('–í—Ö–æ–¥ —á–µ—Ä–µ–∑ Telegram –≤—ã–ø–æ–ª–Ω–µ–Ω.');
    authModal.style.display='none';
  } else {
    alert('Telegram WebApp –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω. –û—Ç–∫—Ä–æ–π—Ç–µ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –¥–ª—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.');
  }
  updateUserUI();
});

authPhoneBtn.addEventListener('click', ()=> {
  const phone = (authPhone.value || '').trim();
  if(!phone){ alert('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞'); return; }
  // For a real app you would verify via SMS. Here we just store locally.
  const user = { id: 'phone_' + phone.replace(/\D/g,''), name: phone, phone };
  storeUser(user);
  if(!localStorage.getItem('bm_loyalty')) localStorage.setItem('bm_loyalty','0');
  authModal.style.display='none';
  updateUserUI();
  alert('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω –∫–∞–∫ ' + phone + ' (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º).');
});

/* ========== helpers ========= */
function idify(s){ return String(s).replace(/\W+/g,'_'); }
function formatRub(v){ return Math.round(v) + ' ‚ÇΩ'; }
function displayQty(kg){ if(kg<1) return Math.round(kg*1000) + ' –≥'; return kg.toFixed(2) + ' –∫–≥'; }
function randInt(max){ return Math.floor(Math.random()*max); }

/* transliteration & slug for images */
function transliterate(str){
  if(!str) return '';
  const map = {'–∞':'a','–±':'b','–≤':'v','–≥':'g','–¥':'d','–µ':'e','—ë':'e','–∂':'zh','–∑':'z','–∏':'i','–π':'y','–∫':'k','–ª':'l','–º':'m','–Ω':'n','–æ':'o','–ø':'p','—Ä':'r','—Å':'s','—Ç':'t','—É':'u','—Ñ':'f','—Ö':'h','—Ü':'ts','—á':'ch','—à':'sh','—â':'shch','—ä':'','—ã':'y','—å':'','—ç':'e','—é':'yu','—è':'ya'};
  return String(str).split('').map(ch=>{ const lower = ch.toLowerCase(); if(map[lower] !== undefined) return map[lower]; if(/[a-z0-9]/i.test(ch)) return ch; if(/\s/.test(ch)) return '-'; return ''; }).join('');
}
function slugify(name){ return transliterate(name).toLowerCase().replace(/[^a-z0-9\-]+/g,'-').replace(/^-+|-+$/g,''); }

function tryLoadImage(imgEl, name){
  if(!imgEl) return;
  const exts = ['.webp','.jpg','.jpeg','.png'];
  const candidates = [];
  const slug = slugify(name || '');
  if(slug){ exts.forEach(ext => candidates.push('images/' + slug + ext)); }
  const encoded = encodeURIComponent(name || '');
  if(encoded){ exts.forEach(ext => candidates.push('images/' + encoded + ext)); }
  if(name && /^[\x00-\x7F]+$/.test(name)){ exts.forEach(ext => candidates.push('images/' + name + ext)); }
  candidates.push('images/noimage.png');

  let idx = 0;
  function tryNext(){
    if(idx >= candidates.length){ imgEl.src = 'images/noimage.png'; imgEl.onload = ()=> imgEl.style.opacity = '1'; return; }
    const url = candidates[idx];
    const tester = new Image();
    tester.onload = () => { imgEl.src = url; imgEl.onload = ()=> imgEl.style.opacity = '1'; };
    tester.onerror = () => { idx++; tryNext(); };
    tester.src = url;
  }
  tryNext();
}

/* getters for both array and object product formats */
function getLabel(it){ if(!it) return ''; if(Array.isArray(it)) return it[0]||it[1]||''; return it.label||it.name||''; }
function getName(it){ if(!it) return ''; if(Array.isArray(it)) return it[1]||it[0]||''; return it.name||it.label||''; }
function getPrice(it){ if(!it) return 0; if(Array.isArray(it)) return Number(it[2]||0); return Number(it.price||0); }
function getCategory(it){ if(!it) return ''; if(Array.isArray(it)) return it[3]||''; return it.category||''; }

/* ========== renderCatalog ========== */
function renderCatalog(list){
  if(!catalogEl) return;
  catalogEl.innerHTML = '';
  list.forEach((p, idxVisible) => {
    const label = getLabel(p);
    const name = getName(p);
    const price = getPrice(p);
    const category = getCategory(p);

    let globalIdx = products.findIndex(pp => getName(pp) === name && getPrice(pp) === price && String(getCategory(pp)) === String(category));
    if(globalIdx === -1) globalIdx = idxVisible;

    const card = document.createElement('div');
    card.className = 'card fade-in';
    card.dataset.prodName = name;
    card.dataset.prodLabel = label;
    card.dataset.prodPrice = price;

    card.innerHTML = `
      <div class="photo"><img alt="${name}" loading="lazy"></div>
      <div class="info">
        <div class="name">${label}</div>
        <div class="desc">${name}</div>
        <div style="display:flex;align-items:center;justify-content:space-between;margin-top:auto;gap:8px">
          <div class="price">${price} ‚ÇΩ/–∫–≥</div>
          <div class="actions" style="min-width:120px">
            <input class="qty-input" type="number" min="1" step="1" value="1" title="–ö–æ–ª-–≤–æ">
            <select class="unit-select" title="–ï–¥–∏–Ω–∏—Ü–∞">
              <option value="kg">–∫–≥</option>
              <option value="g">–≥—Ä</option>
            </select>
            <button class="add-to-cart" data-idx="${idxVisible}" data-global-idx="${globalIdx}">+</button>
          </div>
        </div>
        <div class="reco small" data-idx="${idxVisible}"></div>
      </div>
    `;
    catalogEl.appendChild(card);

    // image
    const img = card.querySelector('img');
    tryLoadImage(img, name);

    // recommendations
    const others = products.map((pp,i)=> i !== globalIdx ? pp : null).filter(Boolean);
    const picks = [];
    while(picks.length < 2 && others.length){
      const k = randInt(others.length);
      picks.push(others.splice(k,1)[0]);
    }
    const recoEl = card.querySelector('.reco');
    if(picks.length) recoEl.textContent = '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º: ' + picks.map(x=>getName(x)).join(', ');
  });
  if(shownCountEl) shownCountEl.textContent = list.length;
}

/* ========== Cart logic ========== */
function addToCart(productObj){
  const existing = cart.find(i => i.name === productObj.name && JSON.stringify(i.components||[]) === JSON.stringify(productObj.components||[]));
  if(existing){
    existing.qtyKg += productObj.qtyKg;
    existing.total = existing.qtyKg * existing.price;
  } else {
    cart.push({
      id: idify(productObj.name) + '_' + Math.random().toString(36).slice(2,8),
      name: productObj.name,
      price: productObj.price,
      qtyKg: productObj.qtyKg,
      total: productObj.qtyKg * productObj.price,
      components: productObj.components || null
    });
  }
  renderCart();
}
function removeFromCart(id){ cart = cart.filter(i => i.id !== id); renderCart(); }
function clearCart(){ cart = []; renderCart(); }

function renderCart(){
  if(!cartItemsEl) return;
  cartItemsEl.innerHTML = '';
  let sum = 0;
  cart.forEach(item => {
    sum += item.total;
    const row = document.createElement('div');
    row.className = 'cart-row';
    row.innerHTML = `
      <div style="display:flex;gap:8px;align-items:center">
        <div>
          <div style="font-weight:700">${item.name}${item.components ? ' (Custom)' : ''}</div>
          <div class="small" style="color:var(--muted)">${displayQty(item.qtyKg)} ‚Ä¢ ${formatRub(item.total)}</div>
        </div>
      </div>
      <div style="display:flex;flex-direction:column;gap:6px;align-items:flex-end">
        <button style="background:transparent;border:0;cursor:pointer;color:${'#e74c3c'}" data-remove="${item.id}">‚úï</button>
        <div style="font-weight:700">${formatRub(item.total)}</div>
      </div>
    `;
    cartItemsEl.appendChild(row);
  });

  if(cartSumEl) cartSumEl.textContent = formatRub(sum);
  if(cartCountSmall) cartCountSmall.textContent = cart.length;
  if(fcCountEl) fcCountEl.textContent = cart.length + ' –ø–æ–∑.';
  if(fcTotalEl) fcTotalEl.textContent = formatRub(sum);

  if(cart.length > 0) showFloatingCart(); else hideFloatingCart();

  cartItemsEl.querySelectorAll('[data-remove]').forEach(btn => { btn.onclick = ()=> removeFromCart(btn.dataset.remove); });
}

/* floating cart helpers */
function showFloatingCart(){ if(!floatingCart) return; floatingCart.classList.add('visible'); }
function hideFloatingCart(){ if(!floatingCart) return; floatingCart.classList.remove('visible'); }

/* ========== Delegation: add to cart from catalog ========== */
document.addEventListener('click', (e) => {
  const btn = e.target.closest('.add-to-cart');
  if(!btn) return;
  const idxVisible = +btn.dataset.idx;
  const idxGlobal = btn.dataset.globalIdx !== undefined ? +btn.dataset.globalIdx : null;
  const card = btn.closest('.card');
  const qtyInput = card.querySelector('.qty-input');
  const unitSelect = card.querySelector('.unit-select');
  const qty = parseFloat(qtyInput.value) || 0;
  const unit = unitSelect.value;
  let qtyKg = unit === 'g' ? qty/1000 : qty;
  if(qtyKg <= 0){ alert('–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ'); return; }
  const source = (visibleProducts && visibleProducts[idxVisible]) || products[idxGlobal] || products[idxVisible];
  const name = getName(source);
  const price = getPrice(source);

  // Only registered users can earn/use points (but adding to cart is allowed for all)
  addToCart({ name, price, qtyKg });

  // small feedback
  const ck = document.createElement('div'); ck.className = 'checkmark'; ck.textContent = '‚úì';
  const c = card; c.style.position = 'relative'; c.appendChild(ck);
  setTimeout(()=>{ ck.style.opacity = '1'; ck.style.transform = 'scale(1)'; }, 10);
  setTimeout(()=>{ ck.style.opacity = '0'; ck.style.transform = 'scale(.6)'; }, 900);
  setTimeout(()=>{ ck.remove(); }, 1200);
});

/* catalog card click -> open product modal (ignore clicks on interactive elements) */
catalogEl.addEventListener('click', (e) => {
  const card = e.target.closest('.card');
  if(!card) return;
  if(e.target.closest('.add-to-cart') || e.target.closest('.qty-input') || e.target.closest('.unit-select')) return;
  const pname = card.dataset.prodName;
  const plabel = card.dataset.prodLabel;
  const pprice = card.dataset.prodPrice;

  pmName.textContent = plabel || pname;
  pmPrice.textContent = pprice ? (pprice + ' ‚ÇΩ/–∫–≥') : '';
  const info = kbjuData[pname];
  if(info){
    pmKbju.textContent = info.kbju;
    pmDesc.textContent = info.desc;
  } else {
    pmKbju.textContent = '–ö–ë–ñ–£ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
    pmDesc.textContent = '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
  }
  pmDesc.style.display = 'none';
  pmMore.textContent = '–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ç–æ–≤–∞—Ä–µ';

  tryLoadImage(pmImg, pname);

  pmQty.value = 1;
  pmUnit.value = 'kg';

  productModal.style.display = 'flex';
  productModal.setAttribute('aria-hidden','false');
});

/* product modal interactions */
pmMore.addEventListener('click', () => {
  if(pmDesc.style.display === 'none'){ pmDesc.style.display = 'block'; pmMore.textContent = '–°–≤–µ—Ä–Ω—É—Ç—å'; }
  else { pmDesc.style.display = 'none'; pmMore.textContent = '–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ç–æ–≤–∞—Ä–µ'; }
});
pmClose.addEventListener('click', () => { productModal.style.display = 'none'; productModal.setAttribute('aria-hidden','true'); });
productModal.addEventListener('click', (e) => { if(e.target === productModal){ productModal.style.display = 'none'; productModal.setAttribute('aria-hidden','true'); } });

/* add to cart from modal */
pmAdd.addEventListener('click', () => {
  const name = pmName.textContent || '';
  const priceText = pmPrice.textContent || '';
  const price = Number((priceText.match(/([\d\.]+)/) || [0,0])[1]) || 0;
  const qtyRaw = parseFloat(pmQty.value) || 0;
  const unit = pmUnit.value;
  let qtyKg = unit === 'g' ? qtyRaw/1000 : qtyRaw;
  if(qtyKg <= 0){ alert('–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ'); return; }

  addToCart({ name, price, qtyKg });

  productModal.style.display = 'none';
  productModal.setAttribute('aria-hidden','true');
});

/* floating cart <-> panel logic */
let cartOpen = false;
function showCartPanel(){ cartPanel.classList.add('show'); cartPanel.setAttribute('aria-hidden','false'); cartOpen = true; hideFloatingCart(); }
function hideCartPanel(){ cartPanel.classList.remove('show'); cartPanel.setAttribute('aria-hidden','true'); cartOpen = false; setTimeout(()=> showFloatingCart(), 120); }
if(floatingCart) floatingCart.addEventListener('click', ()=> { if(!cartOpen) showCartPanel(); else hideCartPanel(); });
if(cartCloseBtn) cartCloseBtn.addEventListener('click', ()=> hideCartPanel());
document.addEventListener('click', (e)=> { if(!cartPanel.classList.contains('show')) return; if(e.target.closest('#cart-panel') || e.target.closest('#floating-cart')) return; hideCartPanel(); });
if(clearCartBtn) clearCartBtn.addEventListener('click', ()=> { clearCart(); hideCartPanel(); });

/* ========== Filters / Search / Sort ========== */
function applySearchAndSort(){
  const q = (searchInput && searchInput.value || '').trim().toLowerCase();
  let list = (currentFilter === 'all' || !currentFilter) ? products.slice() : products.filter(p => String(getCategory(p)) === String(currentFilter));
  if(q){
    list = list.filter(p => ( (getLabel(p) + ' ' + getName(p)).toLowerCase().indexOf(q) !== -1 ));
  }
  const s = (sortSelect && sortSelect.value) || 'default';
  if(s === 'price_asc') list.sort((a,b)=> getPrice(a) - getPrice(b));
  else if(s === 'price_desc') list.sort((a,b)=> getPrice(b) - getPrice(a));
  else if(s === 'name_asc') list.sort((a,b)=> String(getName(a)).localeCompare(String(getName(b)),'ru'));
  else if(s === 'name_desc') list.sort((a,b)=> String(getName(b)).localeCompare(String(getName(a)),'ru'));
  visibleProducts = list;
  renderCatalog(visibleProducts);
}

/* pill filters wiring */
filtersWrap.addEventListener('click', (e)=> {
  const b = e.target.closest('.pill');
  if(!b) return;
  const f = b.dataset.filter || 'all';
  currentFilter = f;
  document.querySelectorAll('#filters .pill').forEach(x=> x.classList.toggle('active', x === b));
  applySearchAndSort();
});

if(searchInput) searchInput.addEventListener('input', ()=> applySearchAndSort());
if(sortSelect) sortSelect.addEventListener('change', ()=> applySearchAndSort());

/* mobile search wiring */
if(fabOpen){
  fabOpen.addEventListener('click', ()=> {
    if(searchPanel) { searchPanel.classList.toggle('open'); mobileSearchInput && mobileSearchInput.focus(); }
  });
}
if(closeSearchPanelBtn){
  closeSearchPanelBtn.addEventListener('click', ()=> { if(searchPanel) searchPanel.classList.remove('open'); });
}
if(mobileSearchInput){
  mobileSearchInput.addEventListener('input', ()=> {
    if(searchInput) searchInput.value = mobileSearchInput.value;
    applySearchAndSort();
  });
}
if(mobileSort){
  mobileSort.addEventListener('change', ()=> {
    if(sortSelect) sortSelect.value = mobileSort.value;
    applySearchAndSort();
  });
}

/* ========== Checkout / order sending ========== */
function sendOrderToAdmin(payload){
  if(!ADMIN_WEBHOOK_URL){
    console.log('ADMIN WEBHOOK not set ‚Äî order payload:', payload);
    return Promise.resolve({ ok: false, reason: 'no_webhook' });
  }
  // send POST JSON to your endpoint; customize as needed (auth headers, etc.)
  return fetch(ADMIN_WEBHOOK_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
  }).then(r=>r.json()).catch(err => { console.error('sendOrderToAdmin error', err); return { ok:false, error: String(err) }; });
}

if(gotoCheckoutBtn) gotoCheckoutBtn.addEventListener('click', ()=> {
  if(cart.length === 0){ alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞ ‚Äî –¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã.'); return; }
  modalOrderList.innerHTML = '';
  let sum = 0;
  cart.forEach(i => {
    const el = document.createElement('div'); el.style.padding='6px 4px';
    el.innerHTML = `<div style="font-weight:700">${i.name}</div><div style="color:var(--muted)">${displayQty(i.qtyKg)} ‚Ä¢ ${formatRub(i.total)}</div>`;
    modalOrderList.appendChild(el);
    sum += i.total;
  });
  modalTotal.textContent = formatRub(sum);
  hideCartPanel();
  checkoutModal.style.display = 'flex';
  checkoutModal.setAttribute('aria-hidden','false');
});

if(closeModalBtn) closeModalBtn.addEventListener('click', ()=> { checkoutModal.style.display='none'; checkoutModal.setAttribute('aria-hidden','true'); if(!cartPanel.classList.contains('show')) setTimeout(()=> showFloatingCart(),120); });

if(deliveryTimeSelect) deliveryTimeSelect.addEventListener('change', (e)=> { customTimeInput.style.display = e.target.value === 'custom' ? 'block' : 'none'; });

if(orderForm) orderForm.addEventListener('submit', (e)=> {
  e.preventDefault();
  if(cart.length === 0){ alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!'); checkoutModal.style.display='none'; return; }

  const name = document.getElementById('cust-name').value.trim();
  const phone = document.getElementById('cust-phone').value.trim();
  const city = document.getElementById('cust-city').value.trim();
  const street = document.getElementById('cust-street').value.trim();
  const house = document.getElementById('cust-house').value.trim();
  const apt = document.getElementById('cust-apartment').value.trim();
  const time = deliveryTimeSelect.value === 'custom' ? (customTimeInput.value || '‚Äî') : '–ö–∞–∫ –º–æ–∂–Ω–æ —Å–∫–æ—Ä–µ–µ';
  const email = document.getElementById('cust-email').value.trim();
  const payment = document.getElementById('payment-method').value;

  const payload = {
    source: 'BravoMarketMiniApp',
    customer: { name, phone, city, street, house, apt, time, email, payment },
    items: cart.map(i=>({name:i.name,qtyKg:i.qtyKg,price:i.price,total:i.total})),
    total: cart.reduce((s,i)=> s+i.total,0),
    timestamp: new Date().toISOString(),
    user: getStoredUser() || null
  };

  // send to admin webhook (if configured)
  sendOrderToAdmin(payload).then(resp=>{
    // success handling may vary
    console.log('admin response', resp);
  });

  // loyalty: only for registered users
  const user = getStoredUser();
  if(user){
    const points = Math.floor(payload.total*0.05);
    const cur = getLoyalty();
    setLoyalty(cur + points);
    alert('–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –ù–∞—á–∏—Å–ª–µ–Ω–æ ' + points + ' –±–∞–ª–ª–æ–≤. –í—Å–µ–≥–æ: ' + (cur+points));
  } else {
    alert('–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω (—Ç–µ—Å—Ç). –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å –±–∞–ª–ª—ã –∏ —Å–∫–∏–¥–∫–∏ ‚Äî –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç.');
  }

  // clear cart
  cart = []; renderCart(); orderForm.reset(); customTimeInput.style.display='none'; checkoutModal.style.display='none';
  setTimeout(()=> showFloatingCart(), 120);
});

/* hero buttons */
if(heroOrderBtn) heroOrderBtn.addEventListener('click', ()=> window.scrollTo({top: document.querySelector('.main').offsetTop - 20, behavior:'smooth'}));
if(viewCatalogBtn) viewCatalogBtn.addEventListener('click', ()=> window.scrollTo({top: document.querySelector('.main').offsetTop - 20, behavior:'smooth'}));

/* ========== init ========== */
function init(){
  // try telegram auto-login if possible
  tryTelegramLogin();
  updateUserUI();

  visibleProducts = products.slice();
  renderCatalog(visibleProducts);
  renderCart();

  // hide floating cart initially until item added
  hideFloatingCart();

  // try to expand webapp if supported
  if(tg && typeof tg.expand === 'function') tg.expand();
}
init();

</script>
</body>
</html>
