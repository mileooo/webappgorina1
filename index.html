<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ú–∞–≥–∞–∑–∏–Ω –æ–≤–æ—â–µ–π –∏ —Ñ—Ä—É–∫—Ç–æ–≤</title>
  <style>
    :root{
      --accent:#27ae60;
      --accent-2:#2ecc71;
      --bg:#f5f7fa;
      --card:#fff;
      --text:#243447;
    }
    *{box-sizing:border-box}
    body{
      font-family: Inter, "Segoe UI", Roboto, Arial, sans-serif;
      margin:0;
      padding:18px;
      background:var(--bg);
      color:var(--text);
    }
    h1{
      text-align:center;
      margin:6px 0 12px;
      font-size:26px;
    }

    .wrap{
      display:grid;
      grid-template-columns: 1fr 340px;
      gap:20px;
      align-items:start;
    }

    /* –ö–∞—Ç–∞–ª–æ–≥ */
    #catalog{
      display:grid;
      grid-template-columns: repeat(auto-fill,minmax(220px,1fr));
      gap:16px;
    }
    .card{
      background:var(--card);
      border-radius:12px;
      padding:12px;
      box-shadow: 0 6px 18px rgba(35,47,56,0.06);
      display:flex;
      flex-direction:column;
      gap:8px;
      min-height:200px;
      transition:transform .12s ease;
    }
    .card:hover{transform:translateY(-4px)}
    .img-placeholder{
      height:110px;
      border-radius:10px;
      background:linear-gradient(90deg,#f0f0f0,#fafafa);
      display:flex;
      align-items:center;
      justify-content:center;
      color:#9aa6b2;
      font-size:14px;
    }
    .title{font-weight:600;font-size:15px;height:40px;overflow:hidden}
    .price{color:#5b6b72;font-size:14px}
    .controls{display:flex;gap:8px;align-items:center;margin-top:auto}
    .qty{
      display:flex;
      gap:6px;
      align-items:center;
      border-radius:8px;
      padding:6px;
      background:#fbfcfd;
      border:1px solid #e8eef2;
    }
    .qty input[type="number"]{
      width:70px;
      border:0;
      outline:none;
      text-align:center;
      font-size:14px;
      background:transparent;
    }
    .unit-select{
      padding:6px 8px;
      border-radius:8px;
      border:1px solid #e8eef2;
      background:white;
      font-size:13px;
    }
    .add-btn{
      background:var(--accent);
      color:white;
      border:0;
      padding:9px 10px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      transition:background .12s;
    }
    .add-btn:hover{background:var(--accent-2)}

    /* –ö–æ—Ä–∑–∏–Ω–∞ */
    .cart{
      position:sticky;
      top:18px;
      background:var(--card);
      border-radius:12px;
      padding:14px;
      box-shadow: 0 6px 18px rgba(35,47,56,0.06);
      max-height:80vh;
      overflow:auto;
    }
    .cart h3{margin:0 0 8px;text-align:center}
    .cart-list{display:flex;flex-direction:column;gap:8px}
    .cart-item{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
      border-radius:8px;
      padding:8px;
      background:#fbfdff;
      border:1px solid #eef6f2;
      font-size:14px;
    }
    .cart-item .left{display:flex;flex-direction:column;gap:6px}
    .cart-controls{display:flex;gap:6px;align-items:center}
    .mini-btn{
      border:1px solid #e3e9ea;
      background:white;
      padding:6px 8px;
      border-radius:8px;
      cursor:pointer;
    }
    .remove{background:#fdecea;color:#b82c1a;border:0;padding:6px 8px;border-radius:8px;cursor:pointer}
    .total{
      margin-top:10px;
      text-align:right;
      font-weight:700;
      font-size:16px;
    }
    .cart-actions{display:flex;gap:8px;margin-top:10px}
    .btn{
      flex:1;
      padding:10px;
      border-radius:10px;
      border:0;
      cursor:pointer;
      font-weight:700;
    }
    .btn-clear{background:#f44336;color:white}
    .btn-check{background:var(--accent);color:white}

    /* –º–æ–±–∏–ª—å–Ω—ã–π */
    @media (max-width:980px){
      .wrap{grid-template-columns:1fr}
      .cart{position:static}
    }
    /* –Ω–µ–±–æ–ª—å—à–∏–µ –ø—Ä–∞–≤–∫–∏ –¥–ª—è –∫—Ä—É—Ç–∏–∑–Ω—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ */
    .muted{color:#6f7f87;font-size:13px}
  </style>
</head>
<body>
  <h1>ü•ï –ú–∞–≥–∞–∑–∏–Ω –æ–≤–æ—â–µ–π –∏ —Ñ—Ä—É–∫—Ç–æ–≤</h1>

  <div class="wrap">
    <!-- –∫–∞—Ç–∞–ª–æ–≥ -->
    <div>
      <div id="catalog"></div>
    </div>

    <!-- –∫–æ—Ä–∑–∏–Ω–∞ -->
    <aside class="cart" id="cart">
      <h3>üõí –ö–æ—Ä–∑–∏–Ω–∞</h3>
      <div id="cart-list" class="cart-list"></div>
      <div class="total" id="cart-total">–ò—Ç–æ–≥–æ: 0 ‚ÇΩ</div>
      <div class="cart-actions">
        <button id="clear-cart" class="btn btn-clear">–û—á–∏—Å—Ç–∏—Ç—å</button>
        <button id="checkout" class="btn btn-check">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
      </div>
      <div style="margin-top:10px;font-size:13px;color:#667f87;text-align:center">–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ –ø–æ–∫–∞ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ</div>
    </aside>
  </div>

  <script>
    // ---- –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ (–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫) ----
    // unitType: "weight" (kg/–≥) –∏–ª–∏ "piece" (—à—Ç/–ø—É—á–æ–∫)
    // avgWeightKg: —Ç–æ–ª—å–∫–æ –¥–ª—è unitType === "piece" ‚Äî —Å—Ä–µ–¥–Ω–∏–π –≤–µ—Å –æ–¥–Ω–æ–π —à—Ç—É–∫–∏ –≤ –∫–≥ (–¥–ª—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ —Ü–µ–Ω—ã)
    const products = [
      { name: "–ê—Ä–±—É–∑", price: 40, unitType: "weight" },
      { name: "–ì—Ä—É—à–∞", price: 340, unitType: "weight" },
      { name: "–ê–ø–µ–ª—å—Å–∏–Ω", price: 220, unitType: "weight" },
      { name: "–î—ã–Ω—è —Ç–æ—Ä–ø–µ–¥–∞ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω", price: 80, unitType: "weight" },
      { name: "–î—ã–Ω—è –∫–æ–ª—Ö–æ–∑–Ω–∏—Ü–∞", price: 80, unitType: "weight" },
      { name: "–í–∏–Ω–æ–≥—Ä–∞–¥ –∑–µ–ª–µ–Ω—ã–π (–±–µ–∑ –∫–æ—Å—Ç–æ—á–µ–∫)", price: 320, unitType: "weight" },
      { name: "–í–∏–Ω–æ–≥—Ä–∞–¥ —Ç–µ–º–Ω—ã–π (–±–µ–∑ –∫–æ—Å—Ç–æ—á–µ–∫)", price: 320, unitType: "weight" },
      { name: "–í–∏–Ω–æ–≥—Ä–∞–¥ —á–µ—Ä–Ω—ã–π (–ú–µ—Ä—Å–µ–¥–µ—Å)", price: 300, unitType: "weight" },
      { name: "–ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∫—Ä–∞—Å–Ω—ã–π", price: 170, unitType: "weight" },
      { name: "–ù–µ–∫—Ç–∞—Ä–∏–Ω –¢—É—Ä—Ü–∏—è", price: 350, unitType: "weight" },
      { name: "–ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∂–µ–ª—Ç—ã–π (–≤–∫—É—Å –ª–∏–º–æ–Ω)", price: 250, unitType: "weight" },
      { name: "–ù–µ–∫—Ç–∞—Ä–∏–Ω –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω –∑–µ–ª–µ–Ω—ã–π", price: 190, unitType: "weight" },
      { name: "–ë–∞–Ω–∞–Ω", price: 170, unitType: "weight" },
      { name: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ß—É–≤–∞—à–∏—è", price: 45, unitType: "weight" },
      { name: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä", price: 45, unitType: "weight" },
      { name: "–ú–æ—Ä–∫–æ–≤—å –í–æ–ª–≥–æ–≥—Ä–∞–¥", price: 45, unitType: "weight" },
      { name: "–õ—É–∫ —Ä–µ–ø—á–∞—Ç—ã–π –í–æ–ª–≥–æ–≥—Ä–∞–¥", price: 45, unitType: "weight" },
      { name: "–õ—É–∫ –∑–µ–ª–µ–Ω—ã–π", price: 350, unitType: "weight" },
      { name: "–£–∫—Ä–æ–ø, –ø–µ—Ç—Ä—É—à–∫–∞", price: 350, unitType: "weight" },
      { name: "–ö–∏–Ω–∑–∞", price: 440, unitType: "weight" },
      { name: "–ë–∞–∑–µ–ª–∏–∫ (–ø—É—á–æ–∫)", price: 50, unitType: "piece", avgWeightKg: 0.03 },
      { name: "–ß–µ—Å–Ω–æ–∫ –¢–∞—à–∫–µ–Ω—Ç", price: 400, unitType: "weight" },
      { name: "–ü–µ—Ä–µ—Ü –±–æ–ª–≥–∞—Ä—Å–∫–∏–π", price: 130, unitType: "weight" },
      { name: "–ü–µ—Ä–µ—Ü —á–∏–ª–∏", price: 25, unitType: "piece", avgWeightKg: 0.02 },
      { name: "–ü–æ–º–∏–¥–æ—Ä—ã –ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω—Å–∫–∏–µ", price: 220, unitType: "weight" },
      { name: "–ü–æ–º–∏–¥–æ—Ä—ã –†–æ—Å—Ç–æ–≤—Å–∫–∏–µ", price: 180, unitType: "weight" },
      { name: "–ü–æ–º–∏–¥–æ—Ä—ã –í–æ–ª–≥–æ–≥—Ä–∞–¥ (–º–µ–ª–∫–∏–µ)", price: 80, unitType: "weight" },
      { name: "–ü–æ–º–∏–¥–æ—Ä—ã –¥–æ–º–∞—à–Ω–∏–µ", price: 240, unitType: "weight" },
      { name: "–ü–æ–º–∏–¥–æ—Ä—ã –ê—Å—Ç—Ä–∞—Ö–∞–Ω—å (–∂–µ–ª—Ç—ã–µ)", price: 190, unitType: "weight" },
      { name: "–û–≥—É—Ä—Ü—ã –ú–æ—Å–∫–æ–≤—Å–∫–∏–µ", price: 150, unitType: "weight" },
      { name: "–û–≥—É—Ä—Ü—ã –°–∞–º–∞—Ä—Å–∫–∏–µ", price: 80, unitType: "weight" },
      { name: "–û–≥—É—Ä—Ü—ã –¥–æ–º–∞—à–Ω–∏–µ", price: 150, unitType: "weight" },
      { name: "–°–ª–∏–≤–∞ 4 –≤–∏–¥–∞", price: 220, unitType: "weight" },
      { name: "–ß–µ—Ä–µ—à–Ω—è", price: 580, unitType: "weight" },
      { name: "–ì–æ–ª—É–±–∏–∫–∞", price: 800, unitType: "weight" },
      { name: "–ê–±—Ä–∏–∫–æ—Å –ê—Ä–º–µ–Ω–∏—è", price: 240, unitType: "weight" },
      { name: "–ê–±—Ä–∏–∫–æ—Å –ö–∏—Ä–≥–∏–∑–∏—è", price: 150, unitType: "weight" },
      { name: "–ü–µ—Ä—Å–∏–∫ –¢–∞—à–∫–µ–Ω—Ç", price: 250, unitType: "weight" },
      { name: "–ü–µ—Ä—Å–∏–∫ –ê—Ä–º–µ–Ω–∏—è", price: 380, unitType: "weight" },
      { name: "–ü–µ—Ä—Å–∏–∫ –¢—É—Ä—Ü–∏—è", price: 450, unitType: "weight" },
      { name: "–ü–µ—Ä—Å–∏–∫ –ò–Ω–∂–∏—Ä–Ω—ã–π", price: 350, unitType: "weight" },
      { name: "–ö–∏–≤–∏", price: 450, unitType: "weight" },
      { name: "–ö–∞–±–∞—á–æ–∫", price: 55, unitType: "weight" },
      { name: "–ë–∞–∫–ª–∞–∂–∞–Ω", price: 130, unitType: "weight" },
      { name: "–õ–∏–º–æ–Ω", price: 290, unitType: "piece", avgWeightKg: 0.15 }
    ];

    // ---- —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã ----
    let cart = [];

    const catalogEl = document.getElementById('catalog');
    const cartListEl = document.getElementById('cart-list');
    const cartTotalEl = document.getElementById('cart-total');
    const clearBtn = document.getElementById('clear-cart');
    const checkoutBtn = document.getElementById('checkout');

    // –ü–æ–º–æ–≥–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å id —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)
    function idify(name){
      return name.replace(/\s+/g,'_').replace(/[^\w\-]/g,'');
    }

    // –§–æ—Ä–º–∞—Ç —á–∏—Å–ª–∞ –≤ —Ä—É–±–ª—è—Ö (—Ü–µ–ª—ã–µ —Ä—É–±–ª–∏)
    function rub(v){
      return Math.round(v) + ' ‚ÇΩ';
    }

    // –†–µ–Ω–¥–µ—Ä –∫–∞—Ç–∞–ª–æ–≥–∞
    function renderCatalog(){
      catalogEl.innerHTML = '';
      products.forEach(prod => {
        const id = idify(prod.name);
        const card = document.createElement('div');
        card.className = 'card';

        // –∫–∞—Ä—Ç–∏–Ω–∫–∞-–∑–∞–≥–ª—É—à–∫–∞ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ/—Ü–µ–Ω–∞
        card.innerHTML = `
          <div class="img-placeholder">–§–æ—Ç–æ (–ø–æ–∫–∞)</div>
          <div class="title">${prod.name}</div>
          <div class="price muted">${prod.price} ‚ÇΩ/–∫–≥</div>
        `;

        // –∫–æ–Ω—Ç—Ä–æ–ª—ã (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞)
        const controls = document.createElement('div');
        controls.className = 'controls';

        // quantity wrapper
        const qtyWrap = document.createElement('div');
        qtyWrap.className = 'qty';

        const qtyInput = document.createElement('input');
        qtyInput.type = 'number';
        qtyInput.id = `qty-${id}`;

        // unit selector
        const unitSelect = document.createElement('select');
        unitSelect.id = `unit-${id}`;
        unitSelect.className = 'unit-select';

        if (prod.unitType === 'weight'){
          // weight: allow kg or g (default kg)
          qtyInput.step = '0.1';
          qtyInput.min = '0.1';
          qtyInput.value = '1';
          unitSelect.innerHTML = `<option value="kg">–∫–≥</option><option value="g">–≥</option>`;
        } else {
          // piece: only integer pieces
          qtyInput.step = '1';
          qtyInput.min = '1';
          qtyInput.value = '1';
          unitSelect.innerHTML = `<option value="pcs">—à—Ç</option>`;
        }

        qtyWrap.appendChild(qtyInput);
        qtyWrap.appendChild(unitSelect);

        const addBtn = document.createElement('button');
        addBtn.className = 'add-btn';
        addBtn.textContent = '–î–æ–±–∞–≤–∏—Ç—å';
        addBtn.onclick = () => addToCart(prod.name);

        controls.appendChild(qtyWrap);
        controls.appendChild(addBtn);

        card.appendChild(controls);
        catalogEl.appendChild(card);
      });
    }

    // –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
    function addToCart(name){
      const prod = products.find(p => p.name === name);
      const id = idify(name);
      const qtyInput = document.getElementById(`qty-${id}`);
      const unitSelect = document.getElementById(`unit-${id}`);
      if(!qtyInput || !unitSelect) return;

      let qty = parseFloat(qtyInput.value);
      if (isNaN(qty) || qty <= 0) { alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ'); return; }

      let unit = unitSelect.value; // 'kg'|'g'|'pcs'
      // –î–ª—è —à—Ç—É—á–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ qty –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ü–µ–ª—ã–º
      if (prod.unitType === 'piece'){
        qty = Math.round(qty);
        if (qty < 1) qty = 1;
      }

      // –ü–µ—Ä–µ–≤–æ–¥–∏–º –∫ –∫–∏–ª–æ–≥—Ä–∞–º–º–∞–º –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω—ã:
      let kgAmount;
      if (prod.unitType === 'weight'){
        if (unit === 'kg') kgAmount = qty;
        else if (unit === 'g') kgAmount = qty / 1000;
        else kgAmount = qty; // fallback
      } else {
        // piece: –∏—Å–ø–æ–ª—å–∑—É–µ–º avgWeightKg (–µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –≤–æ–∑—å–º—ë–º 0.1 –∫–≥)
        const avg = prod.avgWeightKg || 0.1;
        kgAmount = qty * avg;
      }

      const cost = Math.round(prod.price * kgAmount);

      // –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ—Ä–∑–∏–Ω—É (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–∞–∫–æ–π –∂–µ —Ç–æ–≤–∞—Ä —Å —Ç–µ–º –∂–µ —é–Ω–∏—Ç–æ–º ‚Äî —Å–∫–ª–∞–¥—ã–≤–∞–µ–º)
      // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã: —Å—á–∏—Ç–∞–µ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ —Ç–æ–≤–∞—Ä—ã –ø–æ –∏–º–µ–Ω–∏ (—Å–∫–ª–∞–¥—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞)
      const existing = cart.find(item => item.name === name && item.unitLabel === getUnitLabel(prod,unit));
      if (existing){
        existing.qty += qty;
        existing.kg += kgAmount;
        existing.cost += cost;
      } else {
        cart.push({
          name: prod.name,
          pricePerKg: prod.price,
          qty: qty,
          unit: unit, // raw unit code
          unitLabel: getUnitLabel(prod,unit),
          kg: kgAmount,
          cost: cost
        });
      }
      renderCart();
    }

    function getUnitLabel(prod, unit){
      if (prod.unitType === 'weight'){
        return unit === 'kg' ? '–∫–≥' : '–≥';
      } else {
        // piece: display '—à—Ç' or '–ø—É—á–æ–∫' if name contains –ø—É—á–æ–∫
        if (prod.name.toLowerCase().includes('–ø—É—á–æ–∫')) return '–ø—É—á–æ–∫';
        return '—à—Ç';
      }
    }

    // —Ä–µ–Ω–¥–µ—Ä –∫–æ—Ä–∑–∏–Ω—ã
    function renderCart(){
      cartListEl.innerHTML = '';
      let total = 0;
      cart.forEach((it, idx) => {
        total += it.cost;
        const div = document.createElement('div');
        div.className = 'cart-item';

        const left = document.createElement('div');
        left.className = 'left';
        const title = document.createElement('div');
        title.textContent = it.name;
        title.style.fontWeight = '600';
        const sub = document.createElement('div');
        sub.className = 'muted';
        // –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º qty –∏ –µ–¥–∏–Ω–∏—Ü—É; –¥–ª—è –≤–µ—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ –∫–≥ —Å 2 –∑–Ω–∞–∫–∞–º–∏, –¥–ª—è –≥—Ä–∞–º–º ‚Äî –º–æ–∂–µ–º –ø–æ–∫–∞–∑–∞—Ç—å —à—Ç
        let qtyText;
        if (it.unit === 'kg' || it.unit === 'g'){
          // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º kg —Å 2 –∑–Ω–∞–∫–∞–º–∏
          qtyText = `${(it.kg).toFixed(2)} –∫–≥`;
        } else {
          qtyText = `${it.qty} ${it.unitLabel}`;
        }
        sub.textContent = `${qtyText} ‚Äî ${rub(it.cost)}`;
        left.appendChild(title);
        left.appendChild(sub);

        const controls = document.createElement('div');
        controls.className = 'cart-controls';

        const minus = document.createElement('button');
        minus.className = 'mini-btn';
        minus.textContent = '‚àí';
        minus.onclick = () => {
          decrementItem(idx);
        };

        const plus = document.createElement('button');
        plus.className = 'mini-btn';
        plus.textContent = '+';
        plus.onclick = () => {
          incrementItem(idx);
        };

        const remove = document.createElement('button');
        remove.className = 'remove';
        remove.textContent = '–£–¥–∞–ª–∏—Ç—å';
        remove.onclick = () => {
          removeItem(idx);
        };

        controls.appendChild(minus);
        controls.appendChild(plus);
        controls.appendChild(remove);

        div.appendChild(left);
        div.appendChild(controls);

        cartListEl.appendChild(div);
      });

      cartTotalEl.textContent = `–ò—Ç–æ–≥–æ: ${rub(total)}`;
    }

    // –∏–Ω–∫/–¥–µ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ
    function incrementItem(index){
      const it = cart[index];
      const prod = products.find(p => p.name === it.name);
      if (!prod) return;
      if (prod.unitType === 'weight'){
        // —É–≤–µ–ª–∏—á–∏–º –Ω–∞ 0.1 –∫–≥ (100 –≥)
        const deltaKg = 0.1;
        it.kg += deltaKg;
        // –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º qty in displayed unit: if unit was g, keep unit as g but kg changed
        // calc new qty in selected unit
        if (it.unit === 'g'){
          it.qty = Math.round(it.kg * 1000);
        } else {
          it.qty = +(it.kg).toFixed(2);
        }
        it.cost = Math.round(prod.price * it.kg);
      } else {
        // piece: +1 —à—Ç
        it.qty = it.qty + 1;
        const avg = prod.avgWeightKg || 0.1;
        it.kg += avg;
        it.cost = Math.round(prod.price * it.kg);
      }
      renderCart();
    }

    function decrementItem(index){
      const it = cart[index];
      const prod = products.find(p => p.name === it.name);
      if (!prod) return;
      if (prod.unitType === 'weight'){
        const deltaKg = 0.1;
        if (it.kg - deltaKg <= 0.09) {
          // —É–¥–∞–ª—è–µ–º –µ—Å–ª–∏ —Å—Ç–∞–Ω–µ—Ç –Ω–æ–ª—å –∏–ª–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ
          removeItem(index); return;
        }
        it.kg = +(it.kg - deltaKg).toFixed(3);
        if (it.unit === 'g') it.qty = Math.round(it.kg * 1000);
        else it.qty = +(it.kg).toFixed(2);
        it.cost = Math.round(prod.price * it.kg);
      } else {
        // piece
        if (it.qty - 1 <= 0) { removeItem(index); return; }
        it.qty = it.qty - 1;
        const avg = prod.avgWeightKg || 0.1;
        it.kg = +(it.kg - avg).toFixed(4);
        it.cost = Math.round(prod.price * it.kg);
      }
      renderCart();
    }

    function removeItem(index){
      cart.splice(index,1);
      renderCart();
    }

    clearBtn.onclick = () => {
      if (!confirm('–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É?')) return;
      cart = [];
      renderCart();
    };

    // –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ‚Äî –ø–æ–∫–∞ —Ç–µ—Å—Ç–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–∫–Ω–æ —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞–∫–∞–∑–∞.
    checkoutBtn.onclick = () => {
      if (cart.length === 0) { alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!'); return; }
      let lines = cart.map(it => {
        const label = it.unit === 'kg' || it.unit === 'g' ? `${it.kg.toFixed(2)} –∫–≥` : `${it.qty} ${it.unitLabel}`;
        return `${it.name} ‚Äî ${label} ‚Äî ${rub(it.cost)}`;
      });
      const totalText = cartTotalEl.textContent;
      const full = `üõçÔ∏è –ù–æ–≤—ã–π –∑–∞–∫–∞–∑\n\n${lines.join('\n')}\n\n${totalText}`;
      // –ü–æ–∫–∞ —Ç–µ—Å—Ç ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–∫–∞–∑
      alert(full);

      // –ó–¥–µ—Å—å: –≤ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å `full` –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ –≤ Telegram –±–æ—Ç.
      // –ü—Ä–∏–º–µ—Ä: window.fetch('/send-order', {method:'POST', body: JSON.stringify({order:full})})
    };

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    renderCatalog();
    renderCart();
  </script>
</body>
</html>
